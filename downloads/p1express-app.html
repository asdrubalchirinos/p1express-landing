<!doctype html><html lang=en><meta charset=UTF-8><meta content="width=device-width,initial-scale=1" name=viewport><title>P1.express</title><link href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='80' width='80' viewBox='200 200 600 600' role='img' aria-hidden='true'%3E%3Cg stroke='black' stroke-width='12'%3E%3Ccircle cx='500' cy='500' r='292' fill='%23f3c738'/%3E%3Ccircle cx='500' cy='572' r='220' fill='%23c29f2d'/%3E%3Ccircle cx='500' cy='647' r='142' fill='%23927722'/%3E%3Ccircle cx='500' cy='716' r='072' fill='%23000000'/%3E%3C/g%3E%3C/svg%3E" rel=icon type=image/svg+xml><link href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='80' width='80' viewBox='200 200 600 600' role='img' aria-hidden='true'%3E%3Cg stroke='black' stroke-width='12'%3E%3Ccircle cx='500' cy='500' r='292' fill='%23f3c738'/%3E%3Ccircle cx='500' cy='572' r='220' fill='%23c29f2d'/%3E%3Ccircle cx='500' cy='647' r='142' fill='%23927722'/%3E%3Ccircle cx='500' cy='716' r='072' fill='%23000000'/%3E%3C/g%3E%3C/svg%3E" rel=apple-touch-icon><script crossorigin type=module>!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const W=()=>[{key:"personal",name:"Personal",color:"#6366f1",system:!0},{key:"work",name:"Work",color:"#059669",system:!0},{key:"other",name:"Other",color:"#dc2626",system:!0}],Le=(e,t="#6b7280")=>{if(!e||"string"!=typeof e||0===e.trim().length)throw new Error("Label name is required");const a=e.trim();if(a.length>50)throw new Error("Label name must be 50 characters or less");const n=a.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");if(!n)throw new Error("Label name must contain at least one alphanumeric character");if(!/^#[0-9A-Fa-f]{6}$/.test(t))throw new Error("Color must be a valid hex color code (e.g., #ff0000)");return{key:n,name:a,color:t,system:!1}},we=(e,t,a)=>{const n=Le(t,a);if(e.some(e=>e.key===n.key))throw new Error(`A label with the name "${t}" already exists`);return[...e,n]},le=(e,t,a,n)=>{const l=e.findIndex(e=>e.key===t);if(-1===l)throw new Error(`Label with key "${t}" not found`);const s=e[l];if(!a||"string"!=typeof a||0===a.trim().length)throw new Error("Label name is required");const o=a.trim();if(o.length>50)throw new Error("Label name must be 50 characters or less");if(!/^#[0-9A-Fa-f]{6}$/.test(n))throw new Error("Color must be a valid hex color code (e.g., #ff0000)");let r=t;if(!s.system){if(r=o.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),!r)throw new Error("Label name must contain at least one alphanumeric character");if(r!==t&&e.some(e=>e.key===r))throw new Error(`A label with the name "${a}" already exists`)}return e.map((e,t)=>t===l?{...e,key:r,name:o,color:n}:e)},Se=(e,t)=>{const a=e.find(e=>e.key===t);if(!a)throw new Error(`Label with key "${t}" not found`);if(a.system)throw new Error("System labels cannot be deleted");return e.filter(e=>e.key!==t)},I=(e,t)=>e.find(e=>e.key===t)||null,Ie=(e,t,a)=>e.map(e=>e.label===t?{...e,label:a}:e),Me=(e,t)=>e.map(e=>e.label===t?{...e,label:"none"}:e),re=()=>({tasks:[],labels:W(),config:{theme:"grey",filterLabel:"all",searchQuery:"",dateFormat:"auto",layoutMode:"compact"}}),Fe=()=>{const e=localStorage.getItem("p1ExpressData");if(e){const t=JSON.parse(e);if(t.config||(t.config={theme:"grey",filterLabel:"all",searchQuery:"",dateFormat:"auto",layoutMode:"compact"}),t.config.filterLabel||(t.config.filterLabel="all"),t.config.searchQuery||(t.config.searchQuery=""),t.config.dateFormat||(t.config.dateFormat="auto"),t.config.layoutMode||(t.config.layoutMode="compact"),(!t.labels||!Array.isArray(t.labels))&&(t.labels=W()),t.tasks&&Array.isArray(t.tasks)){t.tasks=t.tasks.map(e=>"archived"===e.status?{...e,status:"cancelled"}:e);const e=e=>"finished"===e.status?`finished:${e.finishedDate??"null"}`:"cancelled"===e.status?`cancelled:${e.cancelledDate??"null"}`:`${e.status}:${e.dueDate??"null"}`,a=new Map;t.tasks=t.tasks.map(t=>{if("number"==typeof t.order)return t;const n=e(t),l=a.get(n)??0;return a.set(n,l+1),{...t,order:l}}),t.tasks=t.tasks.map(e=>void 0===e.isRepeated?{...e,isRepeated:!1,repeatFrequency:null,repeatInterval:1,repeatDaysOfWeek:[],repeatEndDate:null,repeatCount:null,originalTaskId:null,repetitionHistory:[]}:e)}return t}return null},v=e=>{localStorage.setItem("p1ExpressData",JSON.stringify(e))},ie=()=>{const e=Date.now(),t="Purpose: The purpose is to ...\n- \n- \n- \n- ",a=e=>String(e).padStart(2,"0"),n=e=>{const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+e);return`${n.getFullYear()}-${a(n.getMonth()+1)}-${a(n.getDate())}`};return[{id:e+1,title:'Discuss the "random ideas" section',status:"finished",completed:!0,order:0,description:t,dueDate:null,finishedDate:n(-1),label:"moc"},{id:e+2,title:"Buy a car: Agreed - Pick it up later",status:"finished",completed:!0,order:1,description:t,dueDate:n(-2),finishedDate:n(-1),label:"personal"},{id:e+4,title:"Deal with PMI IP problem",status:"doing",completed:!1,order:0,description:t,dueDate:n(3),finishedDate:null,label:"normec"},{id:e+5,title:"Insurance car Nader",status:"postponed",completed:!1,order:0,description:t,dueDate:n(10),finishedDate:null,label:"immo"}]},q=(e,t)=>({...e,config:{...e.config,...t}}),te=e=>String(e).padStart(2,"0"),A=e=>`${e.getFullYear()}-${te(e.getMonth()+1)}-${te(e.getDate())}`,E=e=>null==e||""===e||0===e||!1===e?"":"string"==typeof e?e:A(new Date(e)),w=e=>{if(!e)return null;const t=e.split("-");if(3!==t.length)return null;const[a,n,l]=t.map(Number);return isNaN(a)||isNaN(n)||isNaN(l)||n<1||n>12||l<1||l>31?null:e},z=(e,t="auto")=>{if(!e)return"";let a;a="number"==typeof e?A(new Date(e)):e;const n=a.split("-");if(3!==n.length)return"";const[l,s,o]=n.map(Number),r=new Date(l,s-1,o);try{if("dmy"===t)return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}).format(r);if("mdy"===t)return new Intl.DateTimeFormat("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}).format(r);const e=typeof navigator<"u"&&(navigator.languages?.[0]||navigator.language)||void 0;return new Intl.DateTimeFormat(e,{dateStyle:"short"}).format(r)}catch{const e=String(s).padStart(2,"0"),a=String(o).padStart(2,"0");return"dmy"===t?`${a}/${e}/${l}`:"mdy"===t?`${e}/${a}/${l}`:r.toLocaleDateString()}},$=e=>{const t=new Date;return t.setDate(t.getDate()+e),A(t)},ne=e=>{const t=new Date;return t.setMonth(t.getMonth()+e),A(t)},D=()=>A(new Date),T=(e,t)=>e.find(e=>e.id===Number(t)),de=(e,t)=>{const a={id:Date.now(),status:t.status||"doing",completed:!1,order:"number"==typeof t.order?t.order:0,isRepeated:t.isRepeated||!1,repeatFrequency:t.isRepeated?t.repeatFrequency||"weekly":null,repeatInterval:t.repeatInterval||1,repeatDaysOfWeek:t.repeatDaysOfWeek||[],repeatEndDate:t.repeatEndDate||null,repeatCount:t.repeatCount||null,originalTaskId:t.originalTaskId||null,repetitionHistory:t.repetitionHistory||[],...t};return a.isRepeated&&pe(a),[a,...e]},M=(e,t,a)=>e.map(e=>e.id===Number(t)?{...e,...a}:e),ce=(e,t)=>e.filter(e=>e.id!==Number(t)),ue=(e,t,a)=>{if("finished"===a){const a=e.find(e=>e.id===Number(t));if(!V(e,a))return e}let n=e.map(e=>{if(e.id===Number(t)){const t={...e,status:a,completed:"finished"===a};return t.completed&&!e.finishedDate&&(t.finishedDate=D()),t}return e});if("finished"===a){const e=n.find(e=>e.id===Number(t));n=G(n,e)}return n},me=(e,t,a)=>ue(e,t,a),Be=(e,t)=>{const a=e.find(e=>e.id===Number(t));if(!a.completed&&!V(e,a))return e;let n=e.map(e=>{if(e.id===Number(t)){const t=!e.completed,a={...e,completed:t,status:t?"finished":"doing"};return t&&!e.finishedDate&&(a.finishedDate=D()),a}return e});const l=n.find(e=>e.id===Number(t));return l&&l.completed&&(n=G(n,l)),n},xe=(e,t)=>{if(!t||""===t.trim())return e;const a=t.toLowerCase().trim().split(/\s+/);return e.filter(e=>{const t=`${e.title||""} ${e.description||""}`.toLowerCase();return a.every(e=>t.includes(e))})},Te=(e,t)=>"all"===t?e:e.filter(e=>e.label===t),Ce=(e,t,a)=>{let n=Te(e,t);return n=xe(n,a),n},ae=(e,t)=>e.filter(e=>e.status===t),fe=e=>"finished"===e.status?e.finishedDate??null:"cancelled"===e.status?e.cancelledDate??null:e.dueDate??null,qe=(e,t)=>{const a=e=>"finished"===t?e.finishedDate:"cancelled"===t?e.cancelledDate:e.dueDate,n=e=>{if(null==e||""===e)return"";if("string"==typeof e)return e;try{return new Date(e).toISOString().split("T")[0]}catch{return""}};return[...e].filter(e=>e.status===t).sort((e,l)=>{const s=a(e),o=a(l),r=n(s),i=n(o),d=""===r;if(d!==(""===i))return"finished"===t||"cancelled"===t?d?-1:1:d?1:-1;if(r&&i&&r!==i)return"finished"===t?i.localeCompare(r):r.localeCompare(i);const c="number"==typeof e.order?e.order:0,u="number"==typeof l.order?l.order:0;return c!==u?c-u:e.id-l.id})},Ne=(e,t,a,n,l)=>{const s=Number(t),o=e=>{if(null==e||""===e)return null;if("string"==typeof e)return e;try{return new Date(e).toISOString().split("T")[0]}catch{return null}},r=e.filter(e=>e.status===a&&o(fe(e))===o(n)),i=e.find(e=>e.id===s);if(!i)return e;const d=r.findIndex(e=>e.id===s);if(-1===d)return e;r.splice(d,1);const c=Math.max(0,Math.min(l,r.length));r.splice(c,0,i);const u=r.map((e,t)=>({...e,order:t})),m=new Map(u.map(e=>[e.id,e]));return e.map(e=>m.get(e.id)??e)},S=(e,t,a,n,l)=>{const s=Number(t);if("finished"===a){const t=e.find(e=>e.id===s);if(!V(e,t))return e}let o=e.map(e=>{if(e.id!==s)return e;let t={...e,status:a};return t="finished"===a?{...t,finishedDate:n??t.finishedDate??D(),completed:!0}:"cancelled"===a?{...t,cancelledDate:n??t.cancelledDate,completed:!1}:{...t,dueDate:n??null,completed:!1},t});if("finished"===a){const e=o.find(e=>e.id===s);o=G(o,e)}const r=o.find(e=>e.id===s),i=fe(r);return Ne(o,t,a,i??null,l)},$e=e=>{const t=e.filter(e=>"postponed"===e.status);return 0===t.length?null:t[Math.floor(Math.random()*t.length)]},P=(e,t,{dueDate:a,note:n})=>{const l=Number(t);if(!a||"string"!=typeof a)throw new Error("A valid due date is required to postpone a task");if(!n||"string"!=typeof n||0===n.trim().length)throw new Error("A reason is required to postpone a task");return e.map(e=>e.id!==l?e:{...e,status:"postponed",completed:!1,dueDate:a,postponeNote:n.trim(),finishedDate:"finished"===e.status?null:e.finishedDate})},H=(e,t,{cancelledDate:a,note:n})=>{const l=Number(t),s="string"==typeof a&&a?a:D();if(!n||"string"!=typeof n||0===n.trim().length)throw new Error("A reason is required to cancel a task");return e.map(e=>e.id!==l?e:{...e,status:"cancelled",completed:!1,cancelNote:n.trim(),cancelledDate:s,finishedDate:null})},G=(e,t)=>{if(t&&t.completed&&t.isRepeated)try{const a=Ae(t);if(a)return[a,...e]}catch(e){console.warn("Failed to create next repeated task:",e.message)}return e},V=(e,t)=>{if(!t.originalTaskId)return!0;const a=D();return!e.find(e=>e.id!==t.id&&(e.id==t.originalTaskId||e.originalTaskId===t.originalTaskId)&&"finished"===e.status&&e.finishedDate===a)||confirm(`You have already completed a task "${t.title}" today. Do you want to complete another instance of the same task?`)},pe=e=>{if(e.isRepeated){const t=["daily","weekly","monthly","yearly"];if(!e.repeatFrequency||!t.includes(e.repeatFrequency))throw new Error("repeatFrequency is required and must be one of: daily, weekly, monthly, yearly");if(e.repeatInterval<1)throw new Error("repeatInterval must be at least 1");if("weekly"===e.repeatFrequency&&e.repeatDaysOfWeek&&e.repeatDaysOfWeek.length>0){const t=[0,1,2,3,4,5,6];if(e.repeatDaysOfWeek.filter(e=>!t.includes(e)).length>0)throw new Error("repeatDaysOfWeek must contain valid day numbers (0-6)")}}},Ae=e=>{if(!e.isRepeated)throw new Error("Task is not configured for repetition");pe(e);const t=Oe(e);return Pe(e,t)?null:{...e,id:Date.now(),status:"doing",completed:!1,dueDate:t,finishedDate:null,cancelNote:null,cancelledDate:null,postponeNote:null,originalTaskId:e.originalTaskId||e.id,repetitionHistory:[...e.repetitionHistory,{completedTaskId:e.id,completedDate:e.finishedDate||D(),nextDueDate:t}]}},Oe=e=>{const t=new Date(e.dueDate||D()),a=e.repeatInterval||1;switch(e.repeatFrequency){case"daily":t.setDate(t.getDate()+a);break;case"weekly":if(e.repeatDaysOfWeek&&e.repeatDaysOfWeek.length>0)return Re(t,e.repeatDaysOfWeek,a).toISOString().split("T")[0];t.setDate(t.getDate()+7*a);break;case"monthly":t.setMonth(t.getMonth()+a);break;case"yearly":t.setFullYear(t.getFullYear()+a);break;default:throw new Error(`Unsupported repeat frequency: ${e.repeatFrequency}`)}return t.toISOString().split("T")[0]},Re=(e,t,a)=>{const n=[...t].sort((e,t)=>e-t),l=e.getDay(),s=n.find(e=>e>l);if(void 0!==s){const t=s-l,a=new Date(e);return a.setDate(a.getDate()+t),a}{const t=a,s=new Date(e);return s.setDate(s.getDate()+7*t-l),s.setDate(s.getDate()+n[0]),s}},Pe=(e,t)=>!!(e.repeatEndDate&&t>e.repeatEndDate||e.repeatCount&&e.repeatCount>0&&(e.repetitionHistory||[]).length+1>=e.repeatCount),He=e=>{const t=JSON.stringify(e,null,2),a=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(a),l=document.createElement("a");l.href=n,l.download=`p1-express-backup-${(new Date).toISOString().slice(0,10)}.json`,l.click(),URL.revokeObjectURL(n)},We=e=>new Promise((t,a)=>{const n=new FileReader;n.onload=e=>{try{const n=JSON.parse(e.target.result);n&&n.tasks&&n.config?t(n):a(new Error("Invalid file format: missing required properties"))}catch(e){a(new Error("Error parsing file: "+e.message))}},n.onerror=()=>{a(new Error("Error reading file"))},n.readAsText(e)}),Ye=e=>{if(!e||"object"!=typeof e)return{isValid:!1,error:"Invalid state object"};if(!Array.isArray(e.tasks))return{isValid:!1,error:"Tasks must be an array"};if(!e.config||"object"!=typeof e.config)return{isValid:!1,error:"Config must be an object"};for(const t of e.tasks)if(!t.id||!t.title||!t.status)return{isValid:!1,error:"Invalid task structure"};return{isValid:!0}},U=["grey","dark","light"],Ue=e=>{document.documentElement.className="","light"!==e&&document.documentElement.classList.add(`theme-${e}`)},je=e=>{const t=(U.indexOf(e)+1)%U.length;return U[t]},ze=(e,t)=>{let a=null,n=null;const l=e=>{if(e.target.matches(".task-item")){a=e.target.dataset.id;const t=e.target.querySelector(".task-title-text");if(t){const a=document.createElement("div");a.style.cssText="\n          position: absolute;\n          top: -1000px;\n          left: -1000px;\n          background: var(--color-surface);\n          color: var(--color-text-primary);\n          padding: 8px 12px;\n          border-radius: 4px;\n          font-size: 0.85em;\n          border: 1px solid var(--color-border);\n          box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n          white-space: nowrap;\n          font-family: inherit;\n        ",a.textContent=t.textContent,document.body.appendChild(a),e.dataTransfer.setDragImage(a,10,10),setTimeout(()=>{document.body.removeChild(a)},0)}setTimeout(()=>e.target.classList.add("dragging"),0)}},s=e=>{e.target.matches(".task-item")&&e.target.classList.remove("dragging"),a=null,n&&(n.classList.remove("drag-over"),n=null)},o=t=>{t.preventDefault();const a=t.target.closest(".date-subsection")||t.target.closest(".date-group")&&t.target.closest(".date-group").querySelector(".date-subsection")||t.target.closest(".task-section");a&&(e.querySelectorAll(".drag-over").forEach(e=>e.classList.remove("drag-over")),a.classList.add("drag-over"),n=a)},r=n=>{n.preventDefault(),e.querySelectorAll(".drag-over").forEach(e=>e.classList.remove("drag-over"));const l=n.target.closest(".task-section");if(!l||!a)return;const s=l.dataset.statusKey,o=n.target.closest(".date-subsection")||n.target.closest(".date-group")&&n.target.closest(".date-group").querySelector(".date-subsection"),r=o?o.dataset.dateKey:null,i="null"===r?null:r||null;let d=0;if(o){const e=Array.from(o.querySelectorAll(".task-item"));if(0===e.length)d=0;else{const t=n.clientY;let a=e.length;for(let n=0;n<e.length;n++){const l=e[n].getBoundingClientRect();if(t<l.top+l.height/2){a=n;break}}d=a}}else d=Array.from(l.querySelectorAll(".task-item")).length;t.onDrop&&t.onDrop({taskId:a,status:s,dateKey:i,newIndex:d})};return e.addEventListener("dragstart",l),e.addEventListener("dragend",s),e.addEventListener("dragover",o),e.addEventListener("drop",r),()=>{e.removeEventListener("dragstart",l),e.removeEventListener("dragend",s),e.removeEventListener("dragover",o),e.removeEventListener("drop",r)}};function Q(e){const t=parseInt(e.substr(1,2),16)/255,a=parseInt(e.substr(3,2),16)/255,n=parseInt(e.substr(5,2),16)/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))}const Ge="1.0.3",ge={doing:"Doing",postponed:"Postponed",finished:"Finished",cancelled:"Cancelled"},Ve={doing:"title-doing",postponed:"title-postponed",finished:"title-finished",cancelled:"title-cancelled"},Qe={doing:"No active tasks. Click + to create a new task!",postponed:"No postponed tasks. Drag tasks here to work on them later.",finished:"No completed tasks yet. Mark tasks as finished to see them here.",cancelled:"No cancelled tasks."},Ke="No {status} tasks match the current filter.";let l=re(),j=null,L=null,F=null,R={postponeReason:!1,cancelReason:!1,cancelDate:!1};function _e(e){const t=I(l.labels,e);return t?t.name:e}let r={};function Je(){const e=document.getElementById("app-version");e&&(e.textContent=Ge),document.getElementById("details-modal")?.classList.add("hidden"),document.getElementById("import-export-modal")?.classList.add("hidden"),document.getElementById("labels-modal")?.classList.add("hidden"),document.getElementById("help-modal")?.classList.add("hidden"),document.getElementById("settings-modal")?.classList.add("hidden"),r={taskBoard:document.getElementById("task-board"),newTaskBtn:document.getElementById("new-task-btn"),lotteryBtn:document.getElementById("lottery-btn"),labelsBtn:document.getElementById("labels-btn"),themeBtn:document.getElementById("theme-btn"),settingsBtn:document.getElementById("settings-btn"),ioBtn:document.getElementById("io-btn"),detailsModal:document.getElementById("details-modal"),detailsForm:document.getElementById("details-form"),ioModal:document.getElementById("import-export-modal"),labelsModal:document.getElementById("labels-modal"),settingsModal:document.getElementById("settings-modal"),quickStatusModal:document.getElementById("quick-status-modal"),quickStatusForm:document.getElementById("quick-status-form"),helpModal:document.getElementById("help-modal"),labelsList:document.getElementById("labels-list"),labelForm:document.getElementById("label-form"),importBtn:document.getElementById("import-btn"),exportBtn:document.getElementById("export-btn"),importFileInput:document.getElementById("import-file-input"),taskSearch:document.getElementById("task-search"),labelFilter:document.getElementById("label-filter"),mobileLabelFilter:document.getElementById("mobile-label-filter"),dateFormatSelect:document.getElementById("date-format"),layoutModeSelect:document.getElementById("layout-mode"),settingsCancelBtn:document.getElementById("settings-cancel")};const t=Fe();t?l=t:(l.tasks=ie(),v(l)),rt(),b(),function(){const e=navigator.platform.toLowerCase().includes("mac");document.querySelectorAll(".platform-key").forEach(t=>{t.dataset.mac&&t.dataset.pc&&(t.textContent=e?t.dataset.mac:t.dataset.pc)})}()}function b(){Ue(l.config.theme),lt(),et()}function Ze(){const e={};return document.querySelectorAll(".task-section").forEach(t=>{t.dataset.statusKey&&(e[t.dataset.statusKey]=t.open)}),e}function Xe(e){0!==Object.keys(e).length&&Object.keys(e).forEach(t=>{const a=document.querySelector(`[data-status-key="${t}"]`);a&&(a.open=e[t])})}function et(){const e=Ze();r.taskBoard.innerHTML="",r.taskBoard.className="compact"===l.config.layoutMode?"compact-mode":"";const t=Ce(l.tasks,l.config.filterLabel,l.config.searchQuery);Object.keys(ge).forEach(e=>{const a=ae(l.tasks,e),n=ae(t,e),s="all"!==l.config.filterLabel||""!==l.config.searchQuery.trim(),o=tt(e,a.length,n.length,s),i=o.querySelector(".task-list"),d=n;if(0===d.length){const t=l.tasks.some(t=>t.status===e),a=("all"!==l.config.filterLabel||""!==l.config.searchQuery.trim())&&t;i.appendChild(ot(e,a))}else at(d,e).forEach((e,t)=>{const a=document.createElement("div");a.className="date-group";const n=e.title,s="extended"===l.config.layoutMode?`<div class="date-group-header">${n}</div>`:"";a.innerHTML=`\n          ${s}\n          <div class="date-subsection" data-date-key="${null===e.dateKey?"null":String(e.dateKey)}" data-group-index="${t}"></div>\n        `;const o=a.querySelector(".date-subsection");e.tasks.forEach(e=>o.appendChild(nt(e))),i.appendChild(a)});r.taskBoard.appendChild(o)}),Xe(e),j&&j(),j=ze(r.taskBoard,{onDrop:({taskId:e,status:t,dateKey:a,newIndex:n})=>{const s=T(l.tasks,e);if(s){if("postponed"===t&&"postponed"!==s.status)return L={kind:"existing",taskId:Number(e),baseFields:{},targetStatus:t},F={dateKey:a,newIndex:n},void oe(t,Number(e),a);if("cancelled"===t&&"cancelled"!==s.status)return L={kind:"existing",taskId:Number(e),baseFields:{},targetStatus:t},F={dateKey:a,newIndex:n},void oe(t,Number(e),a);if("doing"===t){let t;t="doing"===s.status?a??null:null===a?s.dueDate??null:a,l.tasks=S(l.tasks,e,"doing",t,n)}else if("postponed"===t)l.tasks=S(l.tasks,e,"postponed",a??null,n);else if("finished"===t){const t=a??null;l.tasks=S(l.tasks,e,"finished",t,n)}else l.tasks="cancelled"===t?S(l.tasks,e,"cancelled",a??null,n):me(l.tasks,e,t);v(l),b()}}})}function tt(e,t=0,a=0,n=!1){const s=document.createElement("details");s.className=`task-section section-${e}`,s.dataset.statusKey=e,"doing"===e&&(s.open=!0);const o=n&&t!==a?`(${a}/${t})`:`(${t})`,r="extended"===l.config.layoutMode?`<span class="section-subtitle">${st(e)}</span>`:"";return s.innerHTML=`\n    <summary class="section-summary">\n      <svg class="arrow" width="16" height="16" viewBox="0 0 16 16"><path fill="currentColor" d="M6 4l4 4-4 4"></path></svg>\n      <div class="section-titles">\n        <span class="section-title ${Ve[e]}">${ge[e]} ${o}</span>\n        ${r}\n      </div>\n    </summary>\n    <div class="task-list"></div>\n  `,s}function nt(e){const t=document.createElement("div");t.className="task-item "+(e.completed?"completed":""),t.dataset.id=e.id,t.draggable=!0;let a=e.dueDate;"finished"===e.status&&e.finishedDate&&(a=e.finishedDate);const n=z(E(a),l.config.dateFormat),s=D(),o=E(e.dueDate),r="task-date "+("finished"!==e.status&&"cancelled"!==e.status&&o&&o<s&&!e.completed?"overdue":"");let i="";if(e.label&&"none"!==e.label){const t=I(l.labels,e.label);if(t){const a=t.color;i=`<div class="task-label" style="background-color: ${a}; color: ${Q(a)>.5?"black":"white"}">${_e(e.label)}</div>`}}let d="";"postponed"===e.status&&e.postponeNote?d=`<div class="task-reason-icon" data-tooltip="Why: ${e.postponeNote}"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 20a8 8 0 1 1 0-16 8 8 0 0 1 0 16Zm.5-12h-1v5l4 2 .5-.87-3.5-1.76V8Z"></path></svg></div>`:"cancelled"===e.status&&e.cancelNote&&(d=`<div class="task-reason-icon" data-tooltip="Why: ${e.cancelNote}"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M18 6 6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></div>`);let c="";return e.isRepeated&&(c='<div class="task-reason-icon icon-recurring" data-tooltip="Recurring Task"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="14" height="14"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" /></svg></div>'),t.innerHTML=`\n    <div class="task-checkbox" data-action="toggle">\n      <svg width="8" height="8" viewBox="0 0 24 24" fill="currentColor" style="display: ${e.completed?"block":"none"}"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"></path></svg>\n    </div>\n    <div class="task-content" data-action="open">\n      <div class="task-text-content">\n        <span class="task-title-text">${e.title}</span>\n        ${i}\n        ${d}\n        ${c}\n      </div>\n      <span class="${r}">${n}</span>\n    </div>\n    <button class="task-delete-btn" data-action="delete" title="Delete Task">&times;</button>\n  `,t}function at(e,t){const a=qe(e,t),n=new Map;a.forEach(e=>{let a;a="finished"===t?e.finishedDate??null:"cancelled"===t?e.cancelledDate??null:e.dueDate??null;((e,t)=>{const a=n.get(e)||[];a.push(t),n.set(e,a)})(E(a)||null,e)});const s=[],o=Array.from(n.keys());let r;return r="finished"===t?o.filter(e=>null!==e).sort((e,t)=>String(t).localeCompare(String(e))):o.filter(e=>null!==e).sort((e,t)=>String(e).localeCompare(String(t))),"doing"===t||"postponed"===t?(n.has(null)&&s.push({dateKey:null,title:"No date",tasks:n.get(null)}),r.forEach(e=>{const t=E(e);s.push({dateKey:t,title:z(t,l.config.dateFormat),tasks:n.get(e)})})):(n.has(null)&&s.push({dateKey:null,title:"No date",tasks:n.get(null)}),r.forEach(e=>{const t=E(e);s.push({dateKey:t,title:z(t,l.config.dateFormat),tasks:n.get(e)})})),s}function st(e){switch(e){case"doing":case"postponed":return"Due Date";case"finished":return"Finished Date";case"cancelled":return"Cancellation Date";default:return"Date"}}function ot(e,t){const a=document.createElement("div");a.className="empty-state";const n=t?Ke.replace("{status}",e):Qe[e];return a.innerHTML=`\n    <div class="empty-state-content">\n      <span class="empty-state-message">${n}</span>\n    </div>\n  `,a}function lt(){const e='<option value="all">Labels</option>'+l.labels.map(e=>`<option value="${e.key}">${e.name}</option>`).join("");r.labelFilter.innerHTML=e,r.labelFilter.value=l.config.filterLabel,r.mobileLabelFilter&&(r.mobileLabelFilter.innerHTML=e,r.mobileLabelFilter.value=l.config.filterLabel),r.taskSearch&&(r.taskSearch.value=l.config.searchQuery)}function rt(){let e;r.taskBoard.addEventListener("click",dt),r.newTaskBtn.addEventListener("click",()=>J()),r.lotteryBtn.addEventListener("click",ye),r.labelsBtn.addEventListener("click",()=>Z()),r.themeBtn.addEventListener("click",K),r.settingsBtn?.addEventListener("click",he),r.ioBtn.addEventListener("click",()=>x(r.ioModal)),r.taskSearch?.addEventListener("input",t=>{clearTimeout(e),e=setTimeout(()=>{l=q(l,{searchQuery:t.target.value}),v(l),b()},300)}),r.labelFilter.addEventListener("change",se),r.mobileLabelFilter?.addEventListener("change",se),r.dateFormatSelect&&(r.dateFormatSelect.value=l.config.dateFormat||"auto",r.dateFormatSelect.addEventListener("change",e=>{l=q(l,{dateFormat:e.target.value}),v(l),b()})),r.layoutModeSelect&&(r.layoutModeSelect.value=l.config.layoutMode||"compact",r.layoutModeSelect.addEventListener("change",e=>{l=q(l,{layoutMode:e.target.value}),v(l),b()})),r.settingsCancelBtn?.addEventListener("click",()=>{r.settingsModal&&y(r.settingsModal)}),r.importBtn.addEventListener("click",()=>r.importFileInput.click()),r.exportBtn.addEventListener("click",()=>He(l)),r.importFileInput.addEventListener("change",ct),document.getElementById("reset-app-btn")?.addEventListener("click",ut),r.detailsForm.addEventListener("submit",mt),document.getElementById("modal-cancel").addEventListener("click",()=>y(r.detailsModal)),document.getElementById("modal-delete").addEventListener("click",pt),document.getElementById("modal-save").addEventListener("click",()=>r.detailsForm.requestSubmit()),r.quickStatusForm.addEventListener("submit",ht),document.getElementById("quick-status-cancel").addEventListener("click",()=>y(r.quickStatusModal)),document.getElementById("modal-repeat-task").addEventListener("change",ft),document.getElementById("modal-repeat-frequency").addEventListener("change",_),document.getElementById("date-next-week").addEventListener("click",()=>{r.detailsForm.elements.dueDate.value=$(7)}),document.getElementById("date-next-month").addEventListener("click",()=>{r.detailsForm.elements.dueDate.value=ne(1)});const t=document.getElementById("quick-date-next-week"),a=document.getElementById("quick-date-next-month");t&&t.addEventListener("click",()=>{r.quickStatusForm.elements.dueDate.value=$(7),updateLocalDateMirrors(),r.quickStatusForm.elements.postponeNote.focus()}),a&&a.addEventListener("click",()=>{r.quickStatusForm.elements.dueDate.value=ne(1),updateLocalDateMirrors(),r.quickStatusForm.elements.postponeNote.focus()}),document.getElementById("modal-status").addEventListener("change",e=>{ve(e.target.value)}),document.getElementById("details-reason-postpone")?.addEventListener("input",()=>{R.postponeReason=!0}),document.getElementById("details-reason-cancel")?.addEventListener("input",()=>{R.cancelReason=!0}),document.getElementById("details-cancel-date")?.addEventListener("input",()=>{R.cancelDate=!0}),r.labelForm.addEventListener("submit",bt),document.getElementById("label-cancel").addEventListener("click",be),document.getElementById("labels-close").addEventListener("click",()=>y(r.labelsModal)),Lt(),wt(),window.addEventListener("click",gt),window.addEventListener("keydown",yt),it(),Mt()}function it(){const e=document.getElementById("menu-toggle"),t=document.getElementById("mobile-menu");if(!e||!t)return;let a;e.addEventListener("click",a=>{a.stopPropagation();const n=t.classList.toggle("show");e.classList.toggle("active",n),e.setAttribute("aria-expanded",n),t.setAttribute("aria-hidden",!n)}),t.addEventListener("click",a=>{const n=a.target.closest(".mobile-menu-item");if(!n)return;const l=n.dataset.action;switch(t.classList.remove("show"),e.classList.remove("active"),e.setAttribute("aria-expanded","false"),t.setAttribute("aria-hidden","true"),l){case"lottery":ye();break;case"labels":Z();break;case"theme":K();break;case"settings":he();break;case"io":x(r.ioModal)}}),document.addEventListener("click",a=>{!e.contains(a.target)&&!t.contains(a.target)&&t.classList.contains("show")&&(t.classList.remove("show"),e.classList.remove("active"),e.setAttribute("aria-expanded","false"),t.setAttribute("aria-hidden","true"))}),window.addEventListener("resize",()=>{clearTimeout(a),a=setTimeout(()=>{window.innerWidth>768&&(t.classList.remove("show"),e.classList.remove("active"),e.setAttribute("aria-expanded","false"),t.setAttribute("aria-hidden","true"))},250)})}function dt(e){const t=e.target.closest(".task-item");if(!t)return;const a=e.target.closest("[data-action]")?.dataset.action,n=t.dataset.id;"toggle"===a?(l.tasks=Be(l.tasks,n),v(l),b()):"open"===a?J(n):"delete"===a&&confirm("Are you sure you want to delete this task?")&&(l.tasks=ce(l.tasks,n),v(l),b())}function ye(){const e=$e(l.tasks);e?(l.tasks=me(l.tasks,e.id,"doing"),v(l),b()):alert('No tasks in "Postponed" to pick from.')}function K(){const e=je(l.config.theme);l=q(l,{theme:e}),v(l),b()}function he(){r.settingsModal&&(r.dateFormatSelect&&(r.dateFormatSelect.value=l.config.dateFormat||"auto"),r.layoutModeSelect&&(r.layoutModeSelect.value=l.config.layoutMode||"compact"),x(r.settingsModal))}function se(e){l=q(l,{filterLabel:e.target.value}),v(l),b()}function ct(){const e=r.importFileInput.files[0];e&&confirm("This will overwrite all current data. Are you sure?")&&We(e).then(e=>{const t=Ye(e);t.isValid?(l=e,v(l),b(),y(r.ioModal)):alert("Invalid file format: "+t.error)}).catch(e=>{alert(e.message)})}function ut(){if(confirm("This will erase all tasks, labels, and settings and restore the app to its initial state. This cannot be undone. Continue?"))try{localStorage.removeItem("p1ExpressData"),l=re(),l.tasks=ie(),v(l),b(),y(r.ioModal)}catch(e){alert("Failed to reset: "+(e?.message||String(e)))}}function mt(e){e.preventDefault();const t=new FormData(e.target),a=[];t.getAll("repeatDaysOfWeek").forEach(e=>{a.push(parseInt(e))});const n="on"===t.get("isRepeated"),s={title:t.get("title"),description:t.get("description"),dueDate:w(t.get("dueDate")),finishedDate:w(t.get("finishedDate")),label:t.get("label"),status:t.get("status")||"doing",isRepeated:n,repeatFrequency:n?t.get("repeatFrequency")||"weekly":null,repeatInterval:parseInt(t.get("repeatInterval"))||1,repeatDaysOfWeek:a,repeatEndDate:w(t.get("repeatEndDate")),repeatCount:t.get("repeatCount")?parseInt(t.get("repeatCount")):null},o=t.get("id"),i=T(l.tasks,o),d={title:s.title,description:s.description,label:s.label,isRepeated:s.isRepeated,repeatFrequency:s.repeatFrequency,repeatInterval:s.repeatInterval,repeatDaysOfWeek:s.repeatDaysOfWeek,repeatEndDate:s.repeatEndDate,repeatCount:s.repeatCount};if(i)if(s.status!==i.status)if("postponed"===s.status){const e=document.getElementById("details-reason-postpone")?.value?.trim();if(!s.dueDate||!e)return void alert("Please provide Due Date and Postpone reason.");l.tasks=M(l.tasks,o,d),l.tasks=P(l.tasks,o,{dueDate:s.dueDate,note:e})}else if("cancelled"===s.status){const e=document.getElementById("details-reason-cancel")?.value?.trim(),t=document.getElementById("details-cancel-date")?.value||"",a=t?w(t):null;if(!e)return void alert("Please provide a reason to cancel.");l.tasks=M(l.tasks,o,d),l.tasks=H(l.tasks,o,{cancelledDate:a,note:e})}else{l.tasks=ue(l.tasks,o,s.status);const e={...d,dueDate:s.dueDate,finishedDate:s.finishedDate};l.tasks=M(l.tasks,o,e)}else if("postponed"===s.status){const e=document.getElementById("details-reason-postpone")?.value?.trim()||i.postponeNote||"";if(!s.dueDate||!e)return void alert("Please provide Due Date and Postpone reason.");l.tasks=M(l.tasks,o,d),l.tasks=P(l.tasks,o,{dueDate:s.dueDate,note:e})}else if("cancelled"===s.status){const e=document.getElementById("details-reason-cancel")?.value?.trim()||i.cancelNote||"",t=document.getElementById("details-cancel-date")?.value||E(i.cancelledDate),a=t?w(t):null;if(!e)return void alert("Please provide a reason to cancel.");l.tasks=M(l.tasks,o,d),l.tasks=H(l.tasks,o,{cancelledDate:a,note:e})}else l.tasks=M(l.tasks,o,{...s});else l.tasks=de(l.tasks,{...s,status:"doing",id:Number(o)});v(l),b(),y(r.detailsModal)}function ft(e){const t=e.target.checked,a=document.getElementById("repeat-configuration");if(t){a.classList.remove("hidden");_({target:document.getElementById("modal-repeat-frequency")})}else a.classList.add("hidden")}function _(e){const t=e.target.value,a=document.getElementById("repeat-interval-unit"),n=document.getElementById("row-repeat-days");a.textContent={daily:"days",weekly:"weeks",monthly:"months",yearly:"years"}[t]||"weeks","weekly"===t?n.classList.remove("hidden"):n.classList.add("hidden")}function pt(){const e=r.detailsForm.elements.id.value;T(l.tasks,e)&&confirm("Are you sure you want to delete this task?")&&(l.tasks=ce(l.tasks,e),v(l),b(),y(r.detailsModal))}function gt(e){if(e.target===r.detailsModal||e.target===r.ioModal||e.target===r.labelsModal||e.target===r.helpModal||e.target===r.settingsModal){y(r.detailsModal),y(r.ioModal),y(r.labelsModal),y(r.helpModal),y(r.settingsModal);const e=document.querySelector("#import-export-modal .danger-details");e&&(e.open=!1)}e.target===r.quickStatusModal&&y(r.quickStatusModal)}function yt(e){if("Escape"===e.key){y(r.detailsModal),y(r.ioModal),y(r.labelsModal),y(r.quickStatusModal),y(r.helpModal),y(r.settingsModal);const e=document.querySelector("#import-export-modal .danger-details");e&&(e.open=!1)}("k"===e.key||"K"===e.key)&&(navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey:e.ctrlKey)&&(e.preventDefault(),J()),("l"===e.key||"L"===e.key)&&(navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey&&e.shiftKey:e.ctrlKey&&e.shiftKey)&&(e.preventDefault(),Z()),("u"===e.key||"U"===e.key)&&(navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey&&e.shiftKey:e.ctrlKey&&e.shiftKey)&&(e.preventDefault(),K()),("f"===e.key||"F"===e.key)&&(navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey&&e.shiftKey:e.ctrlKey&&e.shiftKey)&&r.taskSearch&&(e.preventDefault(),r.taskSearch.focus(),r.taskSearch.select()),("?"===e.key||"/"===e.key)&&(e.target.matches("input, textarea, select")||(e.preventDefault(),Ee()))}function x(e){e.classList.remove("hidden")}function y(e){if(e.classList.add("hidden"),e===r.ioModal){const e=document.querySelector("#import-export-modal .danger-details");e&&(e.open=!1)}}function oe(e,t=null,a=null){r.quickStatusForm.elements.taskId.value=null!=t?String(t):"",r.quickStatusForm.elements.targetStatus.value=e;const n=document.getElementById("quick-status-title"),s=document.getElementById("quick-postpone-fields"),o=document.getElementById("quick-cancel-fields");if("postponed"===e){n.textContent="Postpone Task",s.classList.remove("hidden"),o.classList.add("hidden"),r.quickStatusForm.elements.dueDate.required=!0,r.quickStatusForm.elements.postponeNote.required=!0,r.quickStatusForm.elements.cancelNote&&(r.quickStatusForm.elements.cancelNote.required=!1);let e="";if(null!=a)e=E(a);else if(null!=t){const a=T(l.tasks,t);a&&a.dueDate&&a.dueDate>D()&&(e=E(a.dueDate))}e||(e=$(7)),r.quickStatusForm.elements.dueDate.value=e,r.quickStatusForm.elements.postponeNote.value=""}else n.textContent="Cancel Task",o.classList.remove("hidden"),s.classList.add("hidden"),r.quickStatusForm.elements.dueDate.required=!1,r.quickStatusForm.elements.postponeNote.required=!1,r.quickStatusForm.elements.cancelNote&&(r.quickStatusForm.elements.cancelNote.required=!0),r.quickStatusForm.elements.cancelledDate.value=null!=a?E(a):D(),r.quickStatusForm.elements.cancelNote.value="";x(r.quickStatusModal),setTimeout(()=>{"postponed"===e?r.quickStatusForm.elements.postponeNote?.focus():r.quickStatusForm.elements.cancelNote?.focus()},50)}function ht(e){if(e.preventDefault(),!L)return void y(r.quickStatusModal);const t=r.quickStatusForm,a=t.elements.targetStatus.value;try{if("existing"===L.kind){const e=L.taskId;if(L.baseFields&&Object.keys(L.baseFields).length&&(l.tasks=M(l.tasks,e,L.baseFields)),"postponed"===a){const a=w(t.elements.dueDate.value),n=t.elements.postponeNote.value;l.tasks=P(l.tasks,e,{dueDate:a,note:n});const s=F;s&&(l.tasks=S(l.tasks,e,"postponed",a,s.newIndex))}else{const a=t.elements.cancelledDate.value,n=a?w(a):null,s=t.elements.cancelNote.value;l.tasks=H(l.tasks,e,{cancelledDate:n,note:s});const o=F;o&&(l.tasks=S(l.tasks,e,"cancelled",n,o.newIndex))}}else if("new"===L.kind){l.tasks=de(l.tasks,{...L.baseFields,status:"doing"});const e=l.tasks[0];if(!e)throw new Error("Failed to create new task");if("postponed"===a){const a=w(t.elements.dueDate.value),n=t.elements.postponeNote.value;l.tasks=P(l.tasks,e.id,{dueDate:a,note:n});const s=F;s&&(l.tasks=S(l.tasks,e.id,"postponed",a,s.newIndex))}else{const a=t.elements.cancelledDate.value,n=a?w(a):null,s=t.elements.cancelNote.value;l.tasks=H(l.tasks,e.id,{cancelledDate:n,note:s});const o=F;o&&(l.tasks=S(l.tasks,e.id,"cancelled",n,o.newIndex))}}}catch(e){return void alert(e.message)}L=null,F=null,v(l),b(),y(r.quickStatusModal),y(r.detailsModal)}function J(e=null){r.detailsForm.reset();let t=null;if(e){document.getElementById("task-modal-title").textContent="Edit Task";const a=T(l.tasks,e);if(!a)return;t=a,r.detailsForm.elements.id.value=a.id,r.detailsForm.elements.title.value=a.title,r.detailsForm.elements.description.value=a.description,r.detailsForm.elements.dueDate.value=E(a.dueDate),r.detailsForm.elements.finishedDate.value=E(a.finishedDate),r.detailsForm.elements.label.value=a.label||"none",r.detailsForm.elements.status.value=a.status||"doing",document.getElementById("modal-delete")?.classList.remove("hidden")}else{document.getElementById("task-modal-title").textContent="Add Task",r.detailsForm.elements.id.value=Date.now(),r.detailsForm.elements.label.value="none",r.detailsForm.elements.status.value="doing",r.detailsForm.elements.dueDate.value=D();const e=document.getElementById("modal-status");e&&(e.disabled=!0),document.getElementById("modal-delete")?.classList.add("hidden"),document.getElementById("row-cancel-date")?.classList.add("hidden")}if(vt(),t&&t.label&&"none"!==t.label){const e=document.querySelector(`.tag-option[data-value="${t.label}"]`);if(e){e.classList.add("selected");const a=I(l.labels,t.label);if(a){const t=Q(a.color)>.5?"black":"white";e.style.backgroundColor=a.color,e.style.color=t}}}const a=t&&t.status||"doing";R={postponeReason:!1,cancelReason:!1,cancelDate:!1};const n=document.getElementById("modal-status");n&&(n.disabled=!t);const s=document.getElementById("details-reason-postpone"),o=document.getElementById("details-reason-cancel"),i=document.getElementById("details-cancel-date");t?"postponed"===t.status&&s?s.value=t.postponeNote||"":"cancelled"===t.status&&(o&&(o.value=t.cancelNote||""),i&&(i.value=E(t.cancelledDate))):(s&&(s.value=""),o&&(o.value=""),i&&(i.value=""));const d=document.getElementById("modal-repeat-task"),c=document.getElementById("modal-repeat-frequency"),u=document.getElementById("modal-repeat-interval"),m=document.getElementById("modal-repeat-end-date"),p=document.getElementById("modal-repeat-count"),f=document.getElementById("repeat-configuration");t&&t.isRepeated?(d.checked=!0,c.value=t.repeatFrequency||"weekly",u.value=t.repeatInterval||1,m.value=E(t.repeatEndDate),p.value=t.repeatCount||"",f.classList.remove("hidden"),"weekly"===t.repeatFrequency&&t.repeatDaysOfWeek&&document.querySelectorAll('input[name="repeatDaysOfWeek"]').forEach(e=>{e.checked=t.repeatDaysOfWeek.includes(parseInt(e.value))}),_({target:c})):(d.checked=!1,c.value="weekly",u.value=1,m.value="",p.value="",f.classList.add("hidden"),document.querySelectorAll('input[name="repeatDaysOfWeek"]').forEach(e=>{e.checked=!1})),ve(a,!0),x(r.detailsModal),setTimeout(()=>{r.detailsForm.elements.title.focus()},100),document.getElementById("status-reason-view")?.classList.add("hidden")}function vt(){const e=document.getElementById("tag-selector");e&&(e.innerHTML="",l.labels.forEach(t=>{const a=document.createElement("div");a.className="tag-option",a.dataset.value=t.key,a.textContent=t.name,a.style.borderColor=t.color,a.addEventListener("click",()=>{const e=a.classList.contains("selected");if(document.querySelectorAll(".tag-option").forEach(e=>{e.classList.remove("selected"),e.style.backgroundColor="",e.style.color=""}),e)document.querySelector('input[name="label"]').value="none";else{a.classList.add("selected");const e=Q(t.color)>.5?"black":"white";a.style.backgroundColor=t.color,a.style.color=e,document.querySelector('input[name="label"]').value=t.key}}),e.appendChild(a)}))}function ve(e,t=!1){const a=document.querySelector(".finished-date-row"),n=document.querySelector('[name="finishedDate"]');if(!a||!n)return;"finished"===e?(a.classList.remove("hidden"),(!t||!n.value)&&(n.value=$(0))):(a.classList.add("hidden"),n.value="");const s=document.getElementById("row-due"),o=document.getElementById("row-cancel-date"),i=document.getElementById("row-reason-postponed"),d=document.getElementById("row-reason-cancelled"),c=document.getElementById("details-reason-postpone"),u=document.getElementById("details-reason-cancel"),m=document.getElementById("details-cancel-date");if(document.getElementById("modal-status"),r.detailsForm.elements.dueDate.required=!1,c&&(c.required=!1),u&&(u.required=!1),"postponed"===e){if(s?.classList.remove("hidden"),o?.classList.add("hidden"),i?.classList.remove("hidden"),d?.classList.add("hidden"),c&&(c.required=!0),!t||!r.detailsForm.elements.dueDate.value){const e=r.detailsForm.elements.id.value,t=T(l.tasks,e);let a="";t&&t.dueDate&&t.dueDate>D()&&(a=E(t.dueDate)),a||(a=$(7)),r.detailsForm.elements.dueDate.value=a}r.detailsForm.elements.dueDate.required=!0,c?.focus()}else"cancelled"===e?(s?.classList.add("hidden"),o?.classList.remove("hidden"),i?.classList.add("hidden"),d?.classList.remove("hidden"),u&&(u.required=!0),(!t||!m?.value)&&m&&(m.value=D()),u?.focus()):(s?.classList.remove("hidden"),o?.classList.add("hidden"),i?.classList.add("hidden"),d?.classList.add("hidden"))}function Z(){Y(),r.labelForm.reset(),r.labelForm.elements.labelKey.value="",document.getElementById("label-save-text").textContent="Add Label",B(),x(r.labelsModal)}function Y(){r.labelsList.innerHTML="",0!==l.labels.length?l.labels.forEach(e=>{const t=document.createElement("div");t.className="label-item",t.innerHTML=`\n      <div class="label-color-dot" style="background-color: ${e.color}"></div>\n      <div class="label-info">\n        <div class="label-name">${e.name}</div>\n        <div class="label-details">${e.system?"System label":"Custom label"} • ${e.key}</div>\n      </div>\n      <div class="label-actions">\n        <button onclick="editLabel('${e.key}')">Edit</button>\n        ${e.system?ke(e)?`<button class="reset" onclick="resetSystemLabel('${e.key}')">Reset</button>`:"":`<button class="delete" onclick="deleteLabel('${e.key}')">Delete</button>`}\n      </div>\n    `,r.labelsList.appendChild(t)}):r.labelsList.innerHTML='\n      <div class="labels-empty-state">\n        <div class="empty-state-icon">\n          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">\n            <path d="M17.63,5.84C17.27,5.33 16.67,5 16,5L5,5.01C3.9,5.01 3,5.9 3,7V17C3,18.1 3.9,19 5,19H16C16.67,19 17.27,18.67 17.63,18.16L22,12L17.63,5.84M16,17H5V7H16L19.55,12L16,17Z"/>\n          </svg>\n        </div>\n        <div class="empty-state-content">\n          <h3 class="empty-state-title">No Custom Labels Yet</h3>\n          <p class="empty-state-description">Create your first custom label to organize tasks your way. You can always edit the default system labels (Personal, Work, Other) below.</p>\n          <div class="empty-state-tip">\n            <strong>💡 Tip:</strong> Labels help you categorize and filter tasks by project, priority, or context.\n          </div>\n        </div>\n      </div>\n    '}function bt(e){e.preventDefault();const t=new FormData(r.labelForm),a=t.get("labelKey"),n=t.get("name").trim(),s=t.get("color");try{if(a){l.labels=le(l.labels,a,n,s);const e=I(l.labels,a)||l.labels.find(e=>e.name===n);e&&e.key!==a&&(l.tasks=Ie(l.tasks,a,e.key))}else l.labels=we(l.labels,n,s);v(l),Y(),be(),b()}catch(e){alert(e.message)}}function kt(e){const t=I(l.labels,e);t&&(r.labelForm.elements.labelKey.value=t.key,r.labelForm.elements.name.value=t.name,r.labelForm.elements.color.value=t.color,document.getElementById("label-save-text").textContent="Update Label",N(t.color),B())}function Et(e){const t=I(l.labels,e);if(!t)return;if(t.system)return void alert("System labels cannot be deleted");const a=l.tasks.filter(t=>t.label===e),n=a.length>0?`Delete "${t.name}"? This will remove the label from ${a.length} task(s).`:`Delete "${t.name}"?`;if(confirm(n))try{l.labels=Se(l.labels,e),l.tasks=Me(l.tasks,e),l.config.filterLabel===e&&(l.config.filterLabel="all"),v(l),Y(),b()}catch(e){alert(e.message)}}function be(){r.labelForm.reset(),r.labelForm.elements.labelKey.value="",document.getElementById("label-save-text").textContent="Add Label",N("#6b7280"),B()}function ke(e){if(!e.system)return!1;const t=W().find(t=>t.key===e.key);return t&&(e.name!==t.name||e.color!==t.color)}function Dt(e){const t=I(l.labels,e);if(!t||!t.system)return void alert("Only system labels can be reset");const a=W().find(t=>t.key===e);if(!a)return void alert("Default values not found for this label");if(!ke(t))return void alert("This label is already at its default values");const n=`Reset "${t.name}" to its default name ("${a.name}") and color?`;if(confirm(n))try{l.labels=le(l.labels,e,a.name,a.color),v(l),Y(),b()}catch(e){alert(e.message)}}function Lt(){const e=document.getElementById("label-color"),t=document.getElementById("color-presets");!e||!t||(t.addEventListener("click",t=>{if(t.target.classList.contains("color-preset")){const a=t.target.dataset.color;e.value=a,N(a),B()}}),e.addEventListener("input",e=>{N(e.target.value),B()}),N(e.value))}function N(e){document.querySelectorAll(".color-preset").forEach(t=>{t.dataset.color===e?t.classList.add("selected"):t.classList.remove("selected")})}function wt(){const e=document.getElementById("label-name"),t=document.getElementById("label-color");!e||!t||(e.addEventListener("input",B),B())}function B(){const e=document.getElementById("label-name"),t=document.getElementById("label-color"),a=document.querySelector('input[name="labelKey"]'),n=document.getElementById("preview-color"),s=document.getElementById("preview-name"),o=document.getElementById("preview-details");if(!(e&&t&&n&&s&&o))return;const r=e.value.trim(),i=t.value,d=a&&a.value;if(n.style.backgroundColor=i,r?(s.textContent=r,s.classList.remove("placeholder")):(s.textContent="Enter label name",s.classList.add("placeholder")),d){const e=I(l.labels,a.value);e&&e.system?o.textContent="System label":o.textContent="Custom label"}else o.textContent="Custom label"}function Ee(){r.helpModal.classList.contains("hidden")?St():y(r.helpModal)}function St(){It(),x(r.helpModal)}function It(){const e=navigator.platform.toUpperCase().indexOf("MAC")>=0;document.querySelectorAll(".platform-key").forEach(t=>{const a=t.dataset.mac,n=t.dataset.pc;a&&n&&(t.textContent=e?a:n)})}function De(e){document.querySelectorAll(".tab-btn").forEach(e=>{e.classList.remove("active")}),document.querySelector(`[data-tab="${e}"]`).classList.add("active"),document.querySelectorAll(".help-panel").forEach(e=>{e.classList.remove("active")}),document.querySelector(`[data-panel="${e}"]`).classList.add("active")}function Mt(){r.helpModal&&(r.helpModal.querySelector(".close-btn").addEventListener("click",()=>{y(r.helpModal)}),r.helpModal.querySelectorAll(".tab-btn").forEach(e=>{e.addEventListener("click",()=>{De(e.dataset.tab)})}))}window.editLabel=kt,window.deleteLabel=Et,window.resetSystemLabel=Dt,window.toggleHelpModal=Ee,window.switchHelpTab=De,document.addEventListener("DOMContentLoaded",Je)</script><style crossorigin rel=stylesheet>:root{--twitter-blue:#2563eb;--twitter-blue-hover:#1d4ed8;--color-bg:#ffffff;--color-surface:#fafafa;--color-border:#e0e0e0;--color-text-primary:#172b4d;--color-text-secondary:#5e6c84;--color-accent:#0052cc;--color-danger:#dc2626;--color-neutral:#6b7280;--checkmark-shadow:1px 1px 2px rgba(0,0,0,.7);--shadow:0 1px 2px rgba(0, 0, 0, .1);--color-doing:124,58,237;--color-postponed:245,158,11;--color-finished:5,150,105;--color-cancelled:220,38,38;--color-text-tertiary:#e3eaf3}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background-color:var(--color-bg);color:var(--color-text-primary);margin:0;padding:24px 24px 72px;transition:background-color .3s,color .3s;overflow-x:hidden}.hidden{display:none!important}.icon-recurring svg{color:var(--color-task-title,var(--color-text-primary));opacity:1}.app-container{max-width:900px;margin:auto;background-color:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--border-radius,4px);box-shadow:var(--shadow);transition:background-color .3s,border-color .3s}.app-header{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-bottom:1px solid var(--color-border);position:relative}.app-header h1{font-size:1.8em;margin:0}.app-header .header-text{padding-right:4px}.header-controls{display:flex;align-items:center;gap:8px}.header-title{display:flex;align-items:center;gap:12px}.app-logo{height:32px;width:32px;object-fit:contain}.icon-btn{background:var(--color-surface);border:1px solid var(--color-border);border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--color-text-secondary);transition:background-color .2s,color .2s}.icon-btn:hover{background-color:var(--color-border);color:var(--color-text-primary)}.icon-btn svg{width:20px;height:20px}#task-search{background-color:var(--color-surface);color:var(--color-text-primary);border:1px solid var(--color-border);border-radius:var(--border-radius,4px);padding:6px 8px;font-size:.9em;width:200px;max-width:200px}#label-filter{background-color:var(--color-surface);color:var(--color-text-primary);border:1px solid var(--color-border);border-radius:var(--border-radius,4px);padding:6px 8px;font-size:.9em}.btn{border:none;border-radius:var(--border-radius,4px);padding:6px 12px;font-size:.8em;font-weight:500;cursor:pointer;transition:background-color .2s,box-shadow .2s;display:flex;align-items:center;gap:6px}.btn-primary{background-color:var(--color-accent);color:#fff}.btn-primary:hover{background-color:#0065ff}.btn-danger{background-color:var(--color-danger);color:#fff}.btn-danger:hover{background-color:#bf2600}.btn-secondary{background-color:var(--color-border);color:var(--color-text-primary)}.btn-secondary:hover{opacity:.8}.task-section{border-bottom:1px solid var(--color-border);transition:background-color .2s}.task-section:last-child{border-bottom:none}.task-section.drag-over{background-color:#0052cc1a}.task-section[data-status-key=doing]{background-color:rgba(var(--color-doing),.1)}.task-section[data-status-key=postponed]{background-color:rgba(var(--color-postponed),.1)}.task-section[data-status-key=finished]{background-color:rgba(var(--color-finished),.1)}.task-section[data-status-key=cancelled]{background-color:rgba(var(--color-cancelled),.1)}.section-summary{display:flex;align-items:center;gap:8px;padding:12px 24px;cursor:pointer;list-style:none}.section-summary::-webkit-details-marker{display:none}.section-summary .arrow{transition:transform .2s}details[open] .section-summary .arrow{transform:rotate(90deg)}.section-title{font-weight:600;font-size:.9em;padding:3px 8px;border-radius:var(--border-radius,4px)}.title-finished{background-color:rgb(var(--color-finished));color:#fff;font-weight:600}.title-postponed{background-color:rgb(var(--color-postponed));color:#fff;font-weight:600}.title-doing{background-color:rgb(var(--color-doing));color:#fff;font-weight:600}.title-cancelled{background-color:rgb(var(--color-cancelled));color:#fff;font-weight:600}.task-list{padding:0 24px 0 56px}.date-group{margin:6px 0 8px}.date-group-header{display:flex;align-items:center;gap:6px;font-size:.8em;color:var(--color-text-secondary);padding:3px 8px;margin:3px 0;border-left:2px solid var(--color-border)}.date-subsection{padding-left:8px;border-left:2px dashed transparent}.date-subsection.drag-over{border-left-color:var(--color-accent);background-color:#0052cc0f}.section-doing .date-group-header{background-color:rgba(var(--color-doing),.7);border-left-color:rgb(var(--color-doing));margin-bottom:0}.section-postponed .date-group-header{background-color:rgba(var(--color-postponed),.7);border-left-color:rgb(var(--color-postponed));margin-bottom:0}.section-finished .date-group-header{background-color:rgba(var(--color-finished),.7);border-left-color:rgb(var(--color-finished));margin-bottom:0}.section-cancelled .date-group-header{background-color:rgba(var(--color-cancelled),.7);border-left-color:rgb(var(--color-cancelled));margin-bottom:0}.section-doing .date-subsection{background-color:rgba(var(--color-doing),.3);padding:8px}.section-postponed .date-subsection{background-color:rgba(var(--color-postponed),.3);padding:8px}.section-finished .date-subsection{background-color:rgba(var(--color-finished),.3);padding:8px}.section-cancelled .date-subsection{background-color:rgba(var(--color-cancelled),.3);padding:8px}.task-item{display:flex;align-items:center;padding:0 4px;gap:6px;border-radius:var(--border-radius,4px);cursor:grab;transition:box-shadow .2s,background-color .2s;font-size:.85em;min-width:0;max-width:100%}.task-item:hover{transition:background-color .2s}.section-doing .task-item:hover{background-color:rgba(var(--color-doing),.5)}.section-postponed .task-item:hover{background-color:rgba(var(--color-postponed),.5)}.section-finished .task-item:hover{background-color:rgba(var(--color-finished),.5)}.section-cancelled .task-item:hover{background-color:rgba(var(--color-cancelled),.5)}.task-item.dragging{opacity:.5;box-shadow:0 4px 8px #0003}.task-item.dragging .task-reason-icon{display:none}.task-content{flex-grow:1;cursor:pointer;display:flex;justify-content:space-between;align-items:center;gap:12px;overflow:visible;min-width:0}.task-title-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:0;flex-shrink:1}.task-date{font-size:.8em;color:var(--color-text-secondary);flex-shrink:0;min-width:80px;text-align:right}.task-date.overdue{color:var(--color-danger);font-weight:500}.task-text-content{display:flex;flex-direction:row;align-items:center;gap:6px;flex-grow:1;min-width:0}.task-label{font-size:.65em;font-weight:500;padding:2px 6px;border-radius:var(--border-radius,4px);display:inline-block}.task-checkbox{width:12px;height:12px;border:2px solid var(--color-text-secondary);border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .2s}.task-item.completed .task-checkbox{border-color:#8bdaff;background-color:#8bdaff}.task-item.completed .task-checkbox svg{display:block;color:var(--color-accent)}.task-delete-btn{background:0 0;border:none;font-size:1.4em;color:var(--color-text-secondary);cursor:pointer;opacity:0;padding:0 8px;transition:opacity .2s}.task-item:hover .task-delete-btn{opacity:1}.task-delete-btn:hover{color:var(--color-danger)}.empty-state{padding:24px 16px;text-align:center;color:var(--color-text-secondary)}.empty-state-content{display:flex;flex-direction:column;align-items:center;gap:8px}.empty-state-message{font-style:italic;font-size:.9em;opacity:.8;line-height:1.4}.task-reason-icon{display:inline-flex;align-items:center;justify-content:center;width:16px;height:auto;padding:2px 0;color:var(--color-text-secondary);cursor:help;flex-shrink:0;position:relative}.task-reason-icon:hover{color:var(--color-text-primary)}.task-reason-icon[data-tooltip]:after{content:attr(data-tooltip);position:absolute;bottom:calc(100% + 8px);left:50%;transform:translate(-50%);background:#000000e6;color:#fff;padding:6px 10px;border-radius:4px;font-size:.75em;font-weight:400;white-space:nowrap;opacity:0;visibility:hidden;pointer-events:none;transition:opacity .1s ease;z-index:1000;box-shadow:0 2px 4px #0003}.task-reason-icon[data-tooltip]:hover:after{opacity:1;visibility:visible;transition-delay:0s}.header-filter[data-tooltip],.icon-btn[data-tooltip],select[data-tooltip]{position:relative}.header-filter[data-tooltip]:after,.icon-btn[data-tooltip]:after,select[data-tooltip]:after{content:attr(data-tooltip);position:absolute;top:calc(100% + 8px);left:50%;transform:translate(-50%);background:#000000e6;color:#fff;padding:6px 10px;border-radius:4px;font-size:.75em;font-weight:400;white-space:nowrap;opacity:0;visibility:hidden;pointer-events:none;transition:opacity .1s ease;z-index:1000;box-shadow:0 2px 4px #0003}.header-filter[data-tooltip]:hover:after,.icon-btn[data-tooltip]:hover:after,select[data-tooltip]:hover:after{opacity:1;visibility:visible;transition-delay:0s}@media (max-width:600px){.task-date{min-width:70px}.task-content{gap:10px}}@media (max-width:480px){.task-date{min-width:60px}.task-content{gap:8px}.task-text-content{gap:4px}}.status-reason-block{margin-top:8px;padding:8px;border-radius:var(--border-radius,4px);background:var(--color-surface);color:var(--color-text-secondary);border:1px solid var(--color-border)}.status-reason-title{font-size:12px;font-weight:600;margin-bottom:4px;opacity:.8}.status-reason-text{font-size:13px}.section-titles{display:flex;flex-direction:column;gap:2px}.section-subtitle{font-size:.7em;color:var(--color-text-secondary);font-weight:500;padding-left:4px}.modal-hint{margin:6px 0 12px;font-size:.85em;color:var(--color-text-secondary)}.danger-zone{margin-top:12px;border-top:1px dashed var(--color-border);padding-top:12px}.danger-label{color:#b91c1c;font-weight:600;font-size:.85em;margin-bottom:6px}.danger-zone details summary{cursor:pointer;color:var(--color-text-primary);margin-bottom:6px}.danger-details{margin-top:4px}.danger-summary{display:flex;align-items:center;gap:6px;list-style:none;font-size:.95em;font-weight:500;padding:4px 0}.danger-summary::-webkit-details-marker{display:none}.danger-summary .chevron{transition:transform .2s ease;color:var(--color-text-secondary)}.danger-details[open] .danger-summary .chevron{transform:rotate(90deg)}.danger-summary:hover{opacity:.85}.danger-text{font-size:.9em;color:var(--color-text-secondary);margin:0 0 10px}.header-controls-collapsible{display:flex;align-items:center;gap:8px}.menu-toggle{display:none;position:relative;width:36px;height:36px}.hamburger-icon{width:18px;height:14px;position:relative;display:flex;flex-direction:column;justify-content:space-between}.hamburger-icon .line{display:block;height:2px;width:100%;background-color:currentColor;border-radius:1px;transform-origin:center;transition:all .3s cubic-bezier(.4,0,.2,1)}.menu-toggle.active .line-top{transform:translateY(6px) rotate(45deg)}.menu-toggle.active .line-middle{opacity:0;transform:scaleX(0)}.menu-toggle.active .line-bottom{transform:translateY(-6px) rotate(-45deg)}.mobile-menu{display:none;position:absolute;top:calc(100% + 1px);right:0;background:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--border-radius,4px);box-shadow:0 4px 12px #00000026;min-width:200px;max-width:250px;z-index:1000;opacity:0;transform:translateY(-10px);transition:opacity .2s ease,transform .2s ease;pointer-events:none;margin-right:16px}.mobile-menu.show{display:block;opacity:1;transform:translateY(0);pointer-events:all}.mobile-menu-item{display:flex;align-items:center;gap:12px;width:100%;padding:12px 16px;background:0 0;border:none;border-bottom:1px solid var(--color-border);color:var(--color-text-primary);font-size:.9em;cursor:pointer;transition:background-color .2s;text-align:left}.mobile-menu-item:last-child{border-bottom:none}.mobile-menu-item:hover{background-color:var(--color-border)}.mobile-menu-item svg{width:18px;height:18px;flex-shrink:0;color:var(--color-text-secondary)}.mobile-menu-filter{padding:12px 16px;border-bottom:1px solid var(--color-border)}.mobile-filter{width:100%;background-color:var(--color-surface);color:var(--color-text-primary);border:1px solid var(--color-border);border-radius:var(--border-radius,4px);padding:8px 12px;font-size:.9em;cursor:pointer}#mobile-label-filter{display:none}@media (max-width:768px){.header-controls-collapsible{display:none}.menu-toggle{display:flex}#label-filter{display:none}#mobile-label-filter{display:block}.app-header .header-text{font-size:1.2em}.header-title{gap:10px}.icon-btn{width:44px;height:44px}.icon-btn svg{width:22px;height:22px}#task-search{width:150px;max-width:150px}.header-filter{min-width:120px;max-width:150px}}@media (max-width:480px){.app-header{padding:12px 16px}.app-header .header-text{font-size:1em}.header-title{gap:8px}#task-search{width:120px;max-width:120px;padding:8px 6px;font-size:.85em}.header-filter{min-width:100px;max-width:120px;padding:8px 6px;font-size:.85em}.header-controls{gap:6px}.mobile-menu{right:0;margin-right:16px;min-width:180px;max-width:calc(100vw - 32px)}}@media (max-width:400px){.app-header{padding:10px 12px}.app-header .header-text{display:none}.header-title{gap:0}#task-search{width:100px;max-width:100px;padding:6px 4px;font-size:.8em}.header-filter{min-width:80px;max-width:100px;padding:6px 4px;font-size:.8em}.header-filter option{font-size:.9em}.header-controls{gap:4px}.icon-btn{width:40px;height:40px}.icon-btn svg{width:20px;height:20px}.mobile-menu{right:0;margin-right:12px;min-width:160px;max-width:calc(100vw - 24px)}.mobile-menu-item{padding:10px 14px;font-size:.85em}}.app-footer{position:fixed;left:0;right:0;bottom:0;border-top:1px solid var(--color-border);padding:8px 24px;color:var(--color-text-secondary);background:var(--color-surface);z-index:10}.footer-content{display:flex;align-items:center;justify-content:center;width:100%;max-width:900px;margin:0 auto}.footer-meta{display:flex;align-items:center;gap:10px}.copyright-text{font-size:.75em;color:var(--color-text-secondary);white-space:nowrap;line-height:1.2}.version-text{font-size:.7em;color:var(--color-text-tertiary);white-space:nowrap;line-height:1.2;font-family:-apple-system,BlinkMacSystemFont,SF Mono,Monaco,Inconsolata,Fira Code,monospace}.developer-credit{font-size:.75em;color:var(--color-text-secondary);white-space:nowrap;line-height:1.2}.developer-credit .twitter-link{color:var(--twitter-blue,#2563eb);text-decoration:none;display:inline-flex;align-items:baseline;gap:3px;transition:color .2s ease}.developer-credit .twitter-link:hover{color:var(--twitter-blue-hover,#1d4ed8)}.developer-credit .x-icon{width:11px;height:11px;opacity:.8;transform:translateY(1px)}.shortcuts-reference{display:flex;align-items:center;justify-content:center;gap:12px;padding:8px 16px;font-size:.8em;color:var(--color-text-secondary)}.shortcuts-reference .shortcut-item{display:flex;align-items:center;gap:6px;white-space:nowrap}.shortcuts-reference .shortcut-key{background-color:var(--color-background);border:1px solid var(--color-border);border-radius:3px;padding:2px 6px;font-family:-apple-system,BlinkMacSystemFont,SF Mono,Monaco,Inconsolata,Fira Code,monospace;font-size:.85em;font-weight:600;color:var(--color-text-primary);box-shadow:0 1px 1px #0000001a;min-width:22px;text-align:center}.shortcuts-reference .shortcut-label{color:var(--color-text-secondary);font-size:.9em}.shortcuts-reference .shortcut-separator{color:var(--color-text-secondary);opacity:.6;margin:0 2px}@media (max-width:768px){.app-footer{padding:8px 16px}.copyright-text{font-size:.7em}.shortcuts-reference{padding:6px 12px;font-size:.75em;gap:8px}.shortcuts-reference .shortcut-item{gap:4px}.shortcuts-reference .shortcut-key{padding:1px 4px;font-size:.8em;min-width:20px}.shortcuts-reference .shortcut-separator{margin:0 1px}}@media (max-width:768px){.app-footer{padding:8px 16px}.footer-content{flex-direction:column;gap:6px}.footer-meta{flex-direction:column;align-items:center;gap:6px}}@media (max-width:480px){.app-footer{padding:8px 12px}.footer-content{flex-direction:column;align-items:stretch;gap:6px}.copyright-text{font-size:.7em;text-align:center}.version-text{font-size:.65em;text-align:center}.developer-credit{font-size:.7em;text-align:center}.developer-credit .x-icon{width:10px;height:10px}.shortcuts-reference{padding:4px 8px;font-size:.7em;gap:6px}.shortcuts-reference .shortcut-key{padding:1px 3px;font-size:.75em;min-width:18px}.shortcuts-reference .shortcut-item{gap:3px}}.compact-mode .task-list>.date-group:first-child{margin:0}.compact-mode .task-list>.date-group:last-child{margin:0 0 8px}.compact-mode .task-list>.date-group:not(:first-child):not(:last-child){margin:0}.compact-mode .task-list>.date-group:first-child .date-subsection{padding:0 .5rem;border-radius:4px 4px 0 0}.compact-mode .task-list>.date-group:last-child .date-subsection{padding:0 .5rem .5rem;border-radius:0 0 4px 4px}.compact-mode .task-list>.date-group:not(:first-child):not(:last-child) .date-subsection{padding:0 .5rem;border-radius:0}.compact-mode .task-list>.date-group:only-child{margin:6px 0 8px}.compact-mode .task-list>.date-group:only-child .date-subsection{padding:.5rem;border-radius:4px}.compact-mode .section-doing .task-list>.date-group:nth-child(odd) .date-subsection{background-color:rgba(var(--color-doing),.3)}.compact-mode .section-doing .task-list>.date-group:nth-child(2n) .date-subsection{background-color:rgba(var(--color-doing),.15)}.compact-mode .section-postponed .task-list>.date-group:nth-child(odd) .date-subsection{background-color:rgba(var(--color-postponed),.3)}.compact-mode .section-postponed .task-list>.date-group:nth-child(2n) .date-subsection{background-color:rgba(var(--color-postponed),.15)}.compact-mode .section-finished .task-list>.date-group:nth-child(odd) .date-subsection{background-color:rgba(var(--color-finished),.3)}.compact-mode .section-finished .task-list>.date-group:nth-child(2n) .date-subsection{background-color:rgba(var(--color-finished),.15)}.compact-mode .section-cancelled .task-list>.date-group:nth-child(odd) .date-subsection{background-color:rgba(var(--color-cancelled),.3)}.compact-mode .section-cancelled .task-list>.date-group:nth-child(2n) .date-subsection{background-color:rgba(var(--color-cancelled),.15)}html.theme-dark{--twitter-blue:#60a5fa;--twitter-blue-hover:#3b82f6;--color-bg:#1d2125;--color-surface:#282c34;--color-border:#3a3f44;--color-text-primary:#d1d5db;--color-text-secondary:#909296;--color-accent:#60a5fa;--color-danger:#f87171;--color-neutral:#9ca3af;--checkmark-shadow:1px 1px 2px rgba(255,255,255,.3);--color-text-tertiary:#c7d6ed}html.theme-grey{--twitter-blue:#60a5fa;--twitter-blue-hover:#3b82f6;--color-bg:#2f2f2f;--color-surface:#3c3c3c;--color-border:#505050;--color-text-primary:#e0e0e0;--color-text-secondary:#b0b0b0;--color-accent:#60a5fa;--color-danger:#fca5a5;--color-neutral:#a1a1aa;--checkmark-shadow:1px 1px 2px rgba(255,255,255,.3);--color-text-tertiary:#e0e0e0}input[type=date]::-webkit-calendar-picker-indicator{filter:none;opacity:1}html.theme-dark input[type=date],html.theme-grey input[type=date]{color-scheme:dark;background-color:var(--color-surface);color:var(--color-text-primary)}html.theme-dark input[type=date]::-webkit-calendar-picker-indicator,html.theme-grey input[type=date]::-webkit-calendar-picker-indicator{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23ffffff'%3e%3cpath stroke-linecap='round' stroke-linejoin='round' d='M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 9v7.5'/%3e%3c/svg%3e")!important;background-size:16px 16px!important;background-repeat:no-repeat!important;background-position:center!important;width:20px!important;height:20px!important;cursor:pointer!important;opacity:1!important}html.theme-dark input[type=date]::-webkit-inner-spin-button,html.theme-grey input[type=date]::-webkit-inner-spin-button{filter:invert(1)!important}html.theme-dark input[type=date]::-webkit-clear-button,html.theme-grey input[type=date]::-webkit-clear-button{filter:invert(1)!important}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0009;display:flex;justify-content:center;align-items:center;z-index:1000}.modal{background-color:var(--color-surface);padding:16px;border-radius:var(--border-radius,4px);box-shadow:0 5px 15px #0000004d;width:90%;max-width:600px}.modal h2{margin-top:0;border-bottom:1px solid var(--color-border);padding-bottom:12px}#details-modal .modal{height:78vh;max-height:90vh;display:flex;flex-direction:column}#details-modal .modal h2{flex-shrink:0}#details-modal #details-form{display:flex;flex-direction:column;flex:1;min-height:0}#details-modal .modal-content{flex:1;overflow:auto;min-height:0;scrollbar-gutter:stable both-edges;--scrollbar-reserve:12px;padding-right:var(--scrollbar-reserve);margin-right:calc(var(--scrollbar-reserve) * -1)}#details-modal .modal-actions{flex-shrink:0;margin-top:12px}.modal-content input:not([type=checkbox]),.modal-content select,.modal-content textarea{width:100%;box-sizing:border-box;font:inherit;padding:6px;border:1px solid var(--color-border);border-radius:var(--border-radius,4px);background-color:var(--color-bg);color:var(--color-text-primary)}.modal-content input[type=text]{margin-bottom:12px}.modal-content input[type=date]{width:100%;box-sizing:border-box;font:inherit;padding:6px;border:1px solid var(--color-border);border-radius:var(--border-radius,4px);background-color:var(--color-bg);color:var(--color-text-primary);min-height:32px}.modal-content textarea{margin-bottom:8px;min-height:120px;resize:vertical}.form-group{margin-bottom:8px}.form-group label{display:block;font-size:.9em;margin-bottom:4px;color:var(--color-text-secondary)}.date-container{display:flex;gap:8px;margin-bottom:8px}.date-group{flex:1}.date-group label{display:block;font-size:.9em;margin-bottom:4px;color:var(--color-text-secondary)}.date-group input{width:100%}.quick-date-controls{display:flex;gap:6px;margin-top:8px;margin-bottom:12px}.form-row{display:flex;gap:16px;margin-bottom:16px}.form-column,.form-column-full{flex:1}.form-column label,.form-column-full label{display:block;font-size:.9em;margin-bottom:4px;color:var(--color-text-secondary)}.modal-content>label{display:block;font-size:.9em;margin:8px 0 4px;color:var(--color-text-secondary)}.form-column input[type=date],.form-column select,.form-column-full input[type=date],.form-column-full select{width:100%;padding:6px;font:inherit;border:1px solid var(--color-border);border-radius:var(--border-radius,4px);background-color:var(--color-bg);color:var(--color-text-primary);min-height:32px;box-sizing:border-box}.form-column textarea,.form-column-full textarea{width:100%;padding:6px;font:inherit;border:1px solid var(--color-border);border-radius:var(--border-radius,4px);background-color:var(--color-bg);color:var(--color-text-primary);min-height:96px;resize:vertical;box-sizing:border-box}.form-column select,.form-column-full select{cursor:pointer}.finished-date-row.hidden{display:none}.finished-date-row{transition:opacity .2s ease}.tag-selector{display:flex;flex-wrap:wrap;gap:6px;padding:6px;min-height:36px}.tag-option{padding:6px 12px;font-size:.85em;background-color:var(--color-surface);border:1px solid var(--color-border);border-radius:16px;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;min-height:32px;box-sizing:border-box}.tag-option:hover{background-color:var(--color-border)}.tag-option.selected{border-width:2px}.form-section{margin-bottom:12px;padding:8px 12px;background-color:var(--color-surface-alt,var(--color-bg));border-left:3px solid var(--color-primary);border-radius:var(--border-radius,4px);border:1px solid var(--color-border)}.form-section .form-row{margin-bottom:12px}.form-section .form-row:last-child{margin-bottom:0}.repeat-interval-group{display:flex;align-items:center;gap:8px}.repeat-interval-group input[type=number]{width:80px;flex-shrink:0}.repeat-interval-group span{font-size:.9em;color:var(--color-text-secondary);white-space:nowrap}.frequency-interval-compact{display:flex;gap:12px;align-items:end}.frequency-interval-compact>.form-column{flex:1}.frequency-interval-compact>.form-column:first-child{flex:1.2}.frequency-interval-compact>.form-column:last-child{flex:.8}@media (max-height:700px){.modal{max-height:90vh;padding:12px}.modal h2{padding-bottom:8px;font-size:1.1em}.form-row{margin-bottom:12px}.form-section{padding:6px 10px;margin-bottom:10px}.day-checkbox{padding:2px 3px;font-size:.7em;min-height:22px}}@media (max-width:480px){.modal{width:95%;max-width:none;margin:0 auto}.frequency-interval-compact{flex-direction:column;gap:8px;align-items:stretch}.days-selector{grid-template-columns:repeat(7,1fr);gap:2px}.day-checkbox{font-size:.65em;padding:1px 2px;min-height:20px}}.days-selector{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-top:6px}.day-checkbox{display:flex;align-items:center;justify-content:center;gap:2px;padding:2px 4px;background-color:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--border-radius,4px);cursor:pointer;font-size:.75em;line-height:1.2;transition:all .2s;min-height:24px;text-align:center}.day-checkbox:hover{background-color:var(--color-border)}.day-checkbox input[type=checkbox]{margin:0;width:auto;transform:scale(1);accent-color:var(--color-primary)}.day-checkbox input[type=checkbox]:checked+span,.day-checkbox:has(input[type=checkbox]:checked){background-color:var(--color-primary);color:#fff;border-color:var(--color-primary)}#modal-repeat-task{transform:scale(1.1);accent-color:var(--color-primary)}.repeat-task-header{padding:8px 12px;background-color:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--border-radius,4px);border-left:3px solid var(--color-primary)}.repeat-task-header label{display:flex;align-items:center;font-weight:500;color:var(--color-text-primary);cursor:pointer;margin-bottom:4px;gap:8px}.repeat-task-header svg{color:var(--color-primary);flex-shrink:0}.repeat-hint{font-size:.85em;color:var(--color-text-secondary);line-height:1.3;margin:0 0 0 24px}.date-group input[type=date]{width:100%;padding:4px 6px;font-size:.9em;min-height:32px}.settings-modal{max-width:420px;padding:20px}.settings-content{display:grid;gap:16px;margin-bottom:16px}.settings-group{display:flex;flex-direction:column;gap:6px}.settings-group label{font-size:.9em;color:var(--color-text-secondary)}.settings-group select{width:100%;padding:6px 8px;font:inherit;border:1px solid var(--color-border);border-radius:var(--border-radius,4px);background-color:var(--color-bg);color:var(--color-text-primary);min-height:32px;box-sizing:border-box}.settings-actions{display:flex;justify-content:flex-end}.labels-list{max-height:300px;overflow-y:auto;margin-bottom:16px;border:1px solid var(--color-border);border-radius:var(--border-radius,4px)}.label-item{display:flex;align-items:center;padding:12px;border-bottom:1px solid var(--color-border);background-color:var(--color-surface)}.label-item:last-child{border-bottom:none}.label-item:hover{background-color:var(--color-bg)}.label-color-dot{width:16px;height:16px;border-radius:50%;margin-right:12px;flex-shrink:0}.label-info{flex:1;display:flex;flex-direction:column;gap:2px}.label-name{font-weight:500;color:var(--color-text-primary)}.label-details{font-size:.85em;color:var(--color-text-secondary)}.label-actions{display:flex;gap:8px}.label-actions button{padding:4px 8px;font-size:.8em;border:1px solid var(--color-border);background-color:var(--color-surface);color:var(--color-text-primary);border-radius:var(--border-radius,4px);cursor:pointer;transition:background-color .2s}.label-actions button:hover{background-color:var(--color-border)}.label-actions button.delete{color:var(--color-danger);border-color:var(--color-danger)}.label-actions button.delete:hover{background-color:var(--color-danger);color:#fff}.label-actions button.reset{color:var(--color-accent);border-color:var(--color-accent)}.label-actions button.reset:hover{background-color:var(--color-accent);color:#fff}.label-form{padding:16px;border:1px solid var(--color-border);border-radius:var(--border-radius,4px);background-color:var(--color-bg);margin-bottom:16px}.label-preview{display:flex;align-items:center;padding:12px;margin-bottom:16px;border:1px solid var(--color-border);border-radius:var(--border-radius,4px);background-color:var(--color-surface);min-height:48px}.label-preview .label-color-dot{width:16px;height:16px;border-radius:50%;margin-right:12px;flex-shrink:0;background-color:var(--color-neutral);transition:background-color .2s ease}.label-preview .label-info{flex:1;display:flex;flex-direction:column;gap:2px}.label-preview .label-name{font-weight:500;color:var(--color-text-primary);transition:color .2s ease}.label-preview .label-name.placeholder{font-style:italic;color:var(--color-text-secondary)}.label-preview .label-details{font-size:.85em;color:var(--color-text-secondary)}.label-form input[type=text]{width:100%;box-sizing:border-box;font:inherit;padding:6px;border:1px solid var(--color-border);border-radius:var(--border-radius,4px);background-color:var(--color-bg);color:var(--color-text-primary);margin-bottom:12px}.color-presets{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:8px;padding:8px;border:1px solid var(--color-border);border-radius:var(--border-radius,4px);background-color:var(--color-surface)}.color-preset{width:24px;height:24px;border:2px solid var(--color-border);border-radius:50%;cursor:pointer;transition:all .2s ease;position:relative}.color-preset:hover{border-color:var(--color-text-primary);transform:scale(1.1)}.color-preset.selected{border-color:var(--color-text-primary);transform:scale(1.15);box-shadow:0 0 0 2px var(--color-accent)}.color-preset.selected:after{content:"✓";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:12px;font-weight:700;text-shadow:var(--checkmark-shadow)}.label-form input[type=color]{width:100%;height:32px;padding:0;border:1px solid var(--color-border);border-radius:var(--border-radius,4px);cursor:pointer}.label-form.hidden{display:none}.labels-empty-state{display:flex;flex-direction:column;align-items:center;padding:32px 16px;text-align:center;background-color:var(--color-surface);border:1px dashed var(--color-border);border-radius:var(--border-radius,4px);margin:8px 0}.empty-state-icon{margin-bottom:16px;color:var(--color-text-secondary);opacity:.6}.empty-state-icon svg{display:block}.labels-empty-state .empty-state-content{max-width:320px}.empty-state-title{font-size:1.1em;font-weight:600;color:var(--color-text-primary);margin:0 0 8px}.empty-state-description{font-size:.9em;color:var(--color-text-secondary);line-height:1.4;margin:0 0 16px}.empty-state-tip{font-size:.85em;color:var(--color-text-secondary);background-color:var(--color-bg);padding:12px;border-radius:var(--border-radius,4px);border:1px solid var(--color-border);line-height:1.3}.empty-state-tip strong{color:var(--color-accent)}.modal-actions{display:flex;justify-content:flex-end;gap:6px;margin-top:12px;padding-top:12px;border-top:1px solid var(--color-border)}#import-export-modal .modal-actions{justify-content:center}@media (max-width:768px){.modal{width:95%;max-width:none;padding:12px;margin:8px;max-height:90vh;overflow-y:auto}.labels-list{max-height:200px}.label-item{padding:10px;flex-wrap:wrap;gap:8px}.label-actions{flex-wrap:wrap;gap:6px;width:100%;justify-content:flex-start}.label-actions button{padding:6px 10px;font-size:.85em;min-width:60px;flex:0 0 auto}.form-row{flex-direction:column;gap:12px;margin-bottom:12px}.form-column{flex:none}.label-form{padding:12px}.label-preview{padding:10px;margin-bottom:12px}.label-preview .label-name{font-size:.95em}.color-presets{padding:6px;gap:8px;justify-content:center}.color-preset{width:28px;height:28px;border-width:2px}.color-preset.selected:after{font-size:14px}.modal-actions{flex-direction:column-reverse;gap:8px}.modal-actions button{width:100%;padding:10px;font-size:.9em;justify-content:center}.label-form input[type=color],.label-form input[type=text]{font-size:16px;padding:8px}.label-form input[type=color]{height:40px}}@media (max-width:480px){.modal{width:98%;margin:4px;padding:10px}.label-item{padding:8px;font-size:.9em}.label-color-dot{width:14px;height:14px;margin-right:10px}.color-presets{padding:4px}.color-preset{width:24px;height:24px}.color-preset.selected:after{font-size:12px}.modal h2{font-size:1.1em;padding-bottom:8px}.labels-empty-state{padding:24px 12px}.empty-state-icon svg{width:40px;height:40px}.labels-empty-state .empty-state-content{max-width:280px}.empty-state-title{font-size:1em}.empty-state-description{font-size:.85em}.empty-state-tip{font-size:.8em;padding:10px}}.help-modal{max-width:900px;width:95%;max-height:90vh;display:flex;flex-direction:column}.help-modal .modal-header{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-bottom:1px solid var(--color-border);flex-shrink:0}.help-modal .modal-header h2{margin:0;font-size:1.4em;color:var(--color-text-primary)}.help-modal .close-btn{background:0 0;border:none;font-size:1.8em;color:var(--color-text-secondary);cursor:pointer;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:all .2s}.help-modal .close-btn:hover{background-color:var(--color-border);color:var(--color-text-primary)}.help-content{display:flex;flex-direction:column;overflow:hidden;flex:1}.help-tabs{display:flex;border-bottom:1px solid var(--color-border);background-color:var(--color-surface);flex-shrink:0}.tab-btn{background:0 0;border:none;padding:12px 16px;font-size:.9em;font-weight:500;color:var(--color-text-secondary);cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;white-space:nowrap}.tab-btn:hover{color:var(--color-text-primary);background-color:var(--color-border)}.tab-btn.active{color:var(--color-accent);border-bottom-color:var(--color-accent);background-color:var(--color-background)}.help-panels{overflow-y:auto;flex:1;padding:0}.help-panel{display:none;padding:24px;animation:fadeIn .2s ease}.help-panel.active{display:block}@keyframes fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.help-panel h3{margin-top:0;margin-bottom:20px;color:var(--color-text-primary);font-size:1.3em;border-bottom:1px solid var(--color-border);padding-bottom:8px}.help-section{margin-bottom:24px}.help-section h4{margin:0 0 12px;color:var(--color-text-primary);font-size:1.1em;font-weight:600}.help-section p{margin:0 0 12px;color:var(--color-text-secondary);line-height:1.5}.help-section ul{margin:0 0 12px;padding-left:20px;color:var(--color-text-secondary);line-height:1.5}.help-section li{margin-bottom:6px}.help-note{color:var(--color-text-secondary);font-style:italic;margin:8px 0}.status-explanations{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;margin-bottom:16px}.status-item{display:flex;flex-direction:column;gap:8px;padding:12px;border-radius:6px;background-color:var(--color-surface);border:1px solid var(--color-border)}.status-badge{font-weight:600;font-size:.9em;padding:4px 10px;border-radius:4px;display:inline-block;width:fit-content}.status-item p{margin:0;font-size:.9em;color:var(--color-text-secondary)}.shortcuts-list{display:flex;flex-direction:column;gap:12px}.shortcut-item{display:flex;align-items:center;gap:16px;padding:8px 0}.shortcut-key{background-color:var(--color-surface);border:1px solid var(--color-border);border-radius:4px;padding:4px 8px;font-family:-apple-system,BlinkMacSystemFont,SF Mono,Monaco,Inconsolata,Fira Code,monospace;font-size:.85em;font-weight:600;color:var(--color-text-primary);min-width:60px;text-align:center;box-shadow:0 1px 2px #0000001a}.shortcut-desc{color:var(--color-text-secondary);font-size:.95em}@media (max-width:768px){.help-modal{width:98%;max-height:95vh;margin:10px}.help-tabs{overflow-x:auto;scrollbar-width:none;-ms-overflow-style:none}.help-tabs::-webkit-scrollbar{display:none}.tab-btn{padding:10px 12px;font-size:.85em;flex-shrink:0}.help-panel{padding:16px}.status-explanations{grid-template-columns:1fr;gap:12px}.shortcut-item{flex-direction:column;align-items:flex-start;gap:8px}.shortcut-key{min-width:auto;align-self:flex-start}}@media (max-width:480px){.help-modal .modal-header{padding:12px 16px}.help-modal .modal-header h2{font-size:1.2em}.help-panel{padding:12px}.help-panel h3{font-size:1.1em}.help-section h4{font-size:1em}}#details-modal .modal-content,#details-modal .repeat-disabled-state,#details-modal .tab-panel{overflow:auto;scrollbar-gutter:stable both-edges;overscroll-behavior:contain}#details-modal .modal-content,#details-modal .repeat-disabled-state,#details-modal .tab-panel{scrollbar-width:thin;scrollbar-color:var(--color-border) transparent}#details-modal .modal-content::-webkit-scrollbar,#details-modal .repeat-disabled-state::-webkit-scrollbar,#details-modal .tab-panel::-webkit-scrollbar{width:10px;height:10px}#details-modal .modal-content::-webkit-scrollbar-track,#details-modal .repeat-disabled-state::-webkit-scrollbar-track,#details-modal .tab-panel::-webkit-scrollbar-track{background:0 0}#details-modal .modal-content::-webkit-scrollbar-thumb,#details-modal .repeat-disabled-state::-webkit-scrollbar-thumb,#details-modal .tab-panel::-webkit-scrollbar-thumb{background-color:var(--color-border);border-radius:8px;border:2px solid transparent;background-clip:padding-box}#details-modal .modal-content::-webkit-scrollbar-thumb:hover,#details-modal .repeat-disabled-state::-webkit-scrollbar-thumb:hover,#details-modal .tab-panel::-webkit-scrollbar-thumb:hover{background-color:var(--color-text-secondary)}#details-modal .modal-content::-webkit-scrollbar-corner,#details-modal .repeat-disabled-state::-webkit-scrollbar-corner,#details-modal .tab-panel::-webkit-scrollbar-corner{background:0 0}</style><div class=app-container><header class=app-header><div class=header-title><img alt="P1.express Logo" class=app-logo src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='80'%20width='80'%20viewBox='200%20200%20600%20600'%20role='img'%20aria-hidden='true'%20%3e%3cg%20stroke='black'%20stroke-width='12'%20%3e%3ccircle%20cx='500'%20cy='500'%20r='292'%20fill='%23f3c738'%20/%3e%3ccircle%20cx='500'%20cy='572'%20r='220'%20fill='%23c29f2d'%20/%3e%3ccircle%20cx='500'%20cy='647'%20r='142'%20fill='%23927722'%20/%3e%3ccircle%20cx='500'%20cy='716'%20r='072'%20fill='%23000000'%20/%3e%3c/g%3e%3c/svg%3e"><h1 class=header-text>P1.express</h1></div><div class=header-controls><input id=task-search class=header-filter placeholder="Search tasks..." data-tooltip="Search in task titles and descriptions"> <select id=label-filter data-tooltip="Filter by label" class=header-filter></select> <button class="icon-btn primary-action" id=new-task-btn data-tooltip="Create new task"><svg viewBox="0 0 24 24" fill=currentColor><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg></button><div class=header-controls-collapsible><button class=icon-btn id=lottery-btn data-tooltip="Pick random task"><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5 xmlns=http://www.w3.org/2000/svg class=size-6><path d="M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z" stroke-linecap=round stroke-linejoin=round /></svg></button> <button class=icon-btn id=labels-btn data-tooltip="Manage labels"><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5 xmlns=http://www.w3.org/2000/svg class=size-6><path d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z" stroke-linecap=round stroke-linejoin=round /></svg></button> <button class=icon-btn id=theme-btn data-tooltip="Switch theme"><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5 xmlns=http://www.w3.org/2000/svg class=size-6><path d="M4.098 19.902a3.75 3.75 0 0 0 5.304 0l6.401-6.402M6.75 21A3.75 3.75 0 0 1 3 17.25V4.125C3 3.504 3.504 3 4.125 3h5.25c.621 0 1.125.504 1.125 1.125v4.072M6.75 21a3.75 3.75 0 0 0 3.75-3.75V8.197M6.75 21h13.125c.621 0 1.125-.504 1.125-1.125v-5.25c0-.621-.504-1.125-1.125-1.125h-4.072M10.5 8.197l2.88-2.88c.438-.439 1.15-.439 1.59 0l3.712 3.713c.44.44.44 1.152 0 1.59l-2.879 2.88M6.75 17.25h.008v.008H6.75v-.008Z" stroke-linecap=round stroke-linejoin=round /></svg></button> <button class=icon-btn id=io-btn data-tooltip="Import & Export"><svg viewBox="0 0 24 24" fill=currentColor><path d=M9,3L5,7H8V14H10V7H13M16,17V10H14V17H11L15,21L19,17H16Z></path></svg></button> <button class=icon-btn id=settings-btn data-tooltip=Settings><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5 xmlns=http://www.w3.org/2000/svg class=size-6><path d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z" stroke-linecap=round stroke-linejoin=round /><path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" stroke-linecap=round stroke-linejoin=round /></svg></button></div><button class="icon-btn menu-toggle" id=menu-toggle aria-expanded=false aria-label=Menu><div class=hamburger-icon><span class="line line-top"></span> <span class="line line-middle"></span> <span class="line line-bottom"></span></div></button></div><div class=mobile-menu id=mobile-menu aria-hidden=true><div class=mobile-menu-filter><select id=mobile-label-filter data-tooltip="Filter by label" class=mobile-filter></select></div><button class=mobile-menu-item data-action=lottery><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5 xmlns=http://www.w3.org/2000/svg class=size-6><path d="M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z" stroke-linecap=round stroke-linejoin=round /></svg> <span>Lottery</span></button> <button class=mobile-menu-item data-action=labels><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5 xmlns=http://www.w3.org/2000/svg class=size-6><path d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z" stroke-linecap=round stroke-linejoin=round /></svg> <span>Manage Labels</span></button> <button class=mobile-menu-item data-action=theme><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5 xmlns=http://www.w3.org/2000/svg class=size-6><path d="M4.098 19.902a3.75 3.75 0 0 0 5.304 0l6.401-6.402M6.75 21A3.75 3.75 0 0 1 3 17.25V4.125C3 3.504 3.504 3 4.125 3h5.25c.621 0 1.125.504 1.125 1.125v4.072M6.75 21a3.75 3.75 0 0 0 3.75-3.75V8.197M6.75 21h13.125c.621 0 1.125-.504 1.125-1.125v-5.25c0-.621-.504-1.125-1.125-1.125h-4.072M10.5 8.197l2.88-2.88c.438-.439 1.15-.439 1.59 0l3.712 3.713c.44.44.44 1.152 0 1.59l-2.879 2.88M6.75 17.25h.008v.008H6.75v-.008Z" stroke-linecap=round stroke-linejoin=round /></svg> <span>Toggle Theme</span></button> <button class=mobile-menu-item data-action=io><svg viewBox="0 0 24 24" fill=currentColor><path d=M9,3L5,7H8V14H10V7H13M16,17V10H14V17H11L15,21L19,17H16Z></path></svg> <span>Import & Export</span></button> <button class=mobile-menu-item data-action=settings><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5 xmlns=http://www.w3.org/2000/svg class=size-6><path d="M21 12.75a8.96 8.96 0 0 0-.106-1.671l1.518-1.178a.818.818 0 0 0 .196-1.043l-1.438-2.49a.818.818 0 0 0-1.02-.36l-1.788.717a8.948 8.948 0 0 0-2.897-1.671l-.27-1.915A.818.818 0 0 0 14.37 3h-2.74a.818.818 0 0 0-.81.688l-.27 1.915a8.948 8.948 0 0 0-2.897 1.671l-1.788-.717a.818.818 0 0 0-1.02.36L2.407 8.858a.818.818 0 0 0 .196 1.043l1.519 1.178A8.96 8.96 0 0 0 4.016 12.75c0 .565.036 1.122.106 1.671l-1.519 1.178a.818.818 0 0 0-.196 1.043l1.438 2.49c.205.355.64.508 1.02.36l1.788-.717a8.948 8.948 0 0 0 2.897 1.671l.27 1.915c.063.397.405.688.81.688h2.74c.405 0 .747-.291.81-.688l.27-1.915a8.948 8.948 0 0 0 2.897-1.671l1.788.717c.38.148.815-.005 1.02-.36l1.438-2.49a.818.818 0 0 0-.196-1.043l-1.518-1.178c.07-.549.106-1.106.106-1.671ZM12 15a3 3 0 1 1 0-6 3 3 0 0 1 0 6Z" stroke-linecap=round stroke-linejoin=round /></svg> <span>Settings</span></button></div></header><main id=task-board></main></div><div class=shortcuts-reference><span class=shortcut-item><kbd class="shortcut-key platform-key" data-mac=⌘K data-pc=Ctrl+K>⌘K</kbd> <span class=shortcut-label>New Task</span> </span><span class=shortcut-separator>•</span> <span class=shortcut-item><kbd class="shortcut-key platform-key" data-mac=⌘⇧L data-pc=Ctrl+Shift+L>⌘⇧L</kbd> <span class=shortcut-label>Manage Labels</span> </span><span class=shortcut-separator>•</span> <span class=shortcut-item><kbd class="shortcut-key platform-key" data-mac=⌘⇧U data-pc=Ctrl+Shift+U>⌘⇧U</kbd> <span class=shortcut-label>Switch Theme</span> </span><span class=shortcut-separator>•</span> <span class=shortcut-item><kbd class="shortcut-key platform-key" data-mac=⌘⇧F data-pc=Ctrl+Shift+F>⌘⇧F</kbd> <span class=shortcut-label>Focus Search</span> </span><span class=shortcut-separator>•</span> <span class=shortcut-item><kbd class=shortcut-key>?</kbd> <span class=shortcut-label>Help</span></span></div><div class="hidden modal-overlay" id=help-modal><div class="modal help-modal"><div class=modal-header><h2>📚 Help & Shortcuts</h2><button class=close-btn aria-label="Close Help">&times;</button></div><div class=help-content><div class=help-tabs><button class="tab-btn active" data-tab=workflow>Workflow</button> <button class=tab-btn data-tab=dragdrop>Drag & Drop</button> <button class=tab-btn data-tab=shortcuts>Shortcuts</button> <button class=tab-btn data-tab=labels>Labels</button> <button class=tab-btn data-tab=features>Features</button></div><div class=help-panels><div class="help-panel active" data-panel=workflow><h3>📋 Task Status & Workflow</h3><div class=help-section><h4>Status Sections</h4><div class=status-explanations><div class=status-item><span class="status-badge title-doing">Doing</span><p>Active tasks you're currently working on. New tasks default to this status.</div><div class=status-item><span class="status-badge title-postponed">Postponed</span><p>Tasks delayed to a future date. Requires a due date and reason for postponing.</div><div class=status-item><span class="status-badge title-finished">Finished</span><p>Completed tasks. Can include a finished date for tracking completion.</div><div class=status-item><span class="status-badge title-cancelled">Cancelled</span><p>Tasks that won't be completed. Requires a cancellation date and reason.</div></div></div><div class=help-section><h4>Status Rules</h4><ul><li><strong>Doing → Postponed:</strong> Opens quick modal for due date and reason<li><strong>Doing → Cancelled:</strong> Opens quick modal for cancellation date and reason<li><strong>Any → Finished:</strong> Direct move with optional finished date<li><strong>Within Same Status:</strong> Direct move between date groups</ul></div></div><div class=help-panel data-panel=dragdrop><h3>🎯 Drag & Drop System</h3><div class=help-section><h4>Drop Zones</h4><ul><li><strong>Date Groups:</strong> Drop on specific dates to assign/change due dates<li><strong>Section Background:</strong> Drop between dates for section change without date<li><strong>Cross-Section:</strong> Moving between statuses may trigger quick modals</ul></div><div class=help-section><h4>Visual Feedback</h4><ul><li><strong>Blue Highlight:</strong> Valid drop zone<li><strong>Dashed Border:</strong> Date subsection hover<li><strong>Drag Opacity:</strong> Item being dragged appears semi-transparent</ul></div><div class=help-section><h4>Date Behavior</h4><ul><li><strong>Drop on Date Group:</strong> Task inherits that date as due date<li><strong>Drop on "No Date":</strong> Removes due date from task<li><strong>Background Drop:</strong> Keeps existing due date</ul></div></div><div class=help-panel data-panel=shortcuts><h3>⌨️ Keyboard Shortcuts</h3><div class=help-section><h4>Main Actions</h4><div class=shortcuts-list><div class=shortcut-item><kbd class=shortcut-key>?</kbd> <span class=shortcut-desc>Toggle this Help modal</span></div><div class=shortcut-item><kbd class="shortcut-key platform-key" data-mac=⌘K data-pc=Ctrl+K>⌘K</kbd> <span class=shortcut-desc>Create new task</span></div><div class=shortcut-item><kbd class="shortcut-key platform-key" data-mac=⌘⇧L data-pc=Ctrl+Shift+L>⌘⇧L</kbd> <span class=shortcut-desc>Manage labels</span></div><div class=shortcut-item><kbd class="shortcut-key platform-key" data-mac=⌘⇧U data-pc=Ctrl+Shift+U>⌘⇧U</kbd> <span class=shortcut-desc>Switch theme</span></div></div></div><div class=help-section><h4>Modal Controls</h4><div class=shortcuts-list><div class=shortcut-item><kbd class=shortcut-key>Esc</kbd> <span class=shortcut-desc>Close any open modal</span></div><div class=shortcut-item><kbd class=shortcut-key>Enter</kbd> <span class=shortcut-desc>Save/Submit in modals</span></div><div class=shortcut-item><kbd class=shortcut-key>Tab</kbd> <span class=shortcut-desc>Navigate form fields</span></div></div></div><div class=help-section><h4>Platform Detection</h4><p class=help-note>Shortcuts automatically adapt to your platform:<ul><li><strong>Mac:</strong> Uses Command (⌘) key combinations<li><strong>PC/Linux:</strong> Uses Ctrl key combinations</ul></div></div><div class=help-panel data-panel=labels><h3>🏷️ Labels & Organization</h3><div class=help-section><h4>Label System</h4><ul><li><strong>Color Coding:</strong> Each label has a unique color for visual organization<li><strong>WCAG Compliance:</strong> Text contrast automatically maintained for accessibility<li><strong>Compact Display:</strong> Labels appear horizontally in task items</ul></div><div class=help-section><h4>Managing Labels</h4><ul><li><strong>Create:</strong> Use "Manage Labels" button or <kbd>⌘⇧L</kbd> / <kbd>Ctrl+Shift+L</kbd><li><strong>Edit:</strong> Click any existing label to modify name or color<li><strong>Delete:</strong> Remove unused labels (warning for labels in use)<li><strong>Color Presets:</strong> Quick color selection with predefined palette</ul></div><div class=help-section><h4>Filtering</h4><ul><li><strong>Label Filter:</strong> Dropdown in header to show only tasks with specific labels<li><strong>"All Labels":</strong> Default view showing all tasks<li><strong>Count Display:</strong> Shows filtered vs total task counts</ul></div></div><div class=help-panel data-panel=features><h3>✨ Interface Features</h3><div class=help-section><h4>Reason Icons</h4><ul><li><strong>⏱️ Clock Icon:</strong> Shows postponed tasks with reason tooltip<li><strong>❌ X Icon:</strong> Shows cancelled tasks with reason tooltip<li><strong>Instant Tooltips:</strong> Hover for immediate reason display</ul></div><div class=help-section><h4>Responsive Design</h4><ul><li><strong>Ultra-Compact:</strong> Maximized information density<li><strong>Mobile Friendly:</strong> Hamburger menu and adaptive spacing<li><strong>Text Truncation:</strong> Long titles show ellipsis on small screens</ul></div><div class=help-section><h4>Additional Features</h4><ul><li><strong>Lottery:</strong> Pick random postponed task for decision-making<li><strong>Import/Export:</strong> Backup and restore all data as JSON<li><strong>Theme Toggle:</strong> Switch between light and dark themes<li><strong>Date Format:</strong> Auto, International, or US date formats</ul></div></div></div></div></div></div><footer class=app-footer><div class=footer-content><div class=footer-meta><span class=copyright-text>© 2025 P1.express</span> <span class=version-text>v<span id=app-version>1.0.0</span></span> <span class=developer-credit>Developed by Asdrúbal Chirinos <a class=twitter-link href=https://twitter.com/achirinos rel=noopener target=_blank><svg viewBox="0 0 24 24" fill=currentColor class=x-icon><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg> @achirinos</a></span></div></div></footer><div class="hidden modal-overlay" id=settings-modal><div class="modal settings-modal"><h2>⚙️ Settings</h2><div class=settings-content><div class=settings-group><label for=date-format>Date format</label> <select id=date-format data-tooltip="Choose date format"><option value=auto>Auto<option value=dmy>International (Day/Month)<option value=mdy>US (Month/Day)</select></div><div class=settings-group><label for=layout-mode>Layout</label> <select id=layout-mode data-tooltip="Choose layout mode"><option value=compact>Compact<option value=extended>Extended</select></div></div><div class=danger-zone><div class=danger-label>Danger zone</div><details class=danger-details><summary class=danger-summary><svg viewBox="0 0 16 16" height=14 width=14 aria-hidden=true class=chevron><path d="M6 4l4 4-4 4" fill=currentColor></path></svg> <span>Reset app to initial state</span></summary><p class=danger-text>This deletes all tasks, labels, and settings and restores the app to its initial state.</p><button class="btn btn-danger" type=button id=reset-app-btn><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3" stroke-linecap=round stroke-linejoin=round /></svg> Reset App</button></details></div><div class="modal-actions settings-actions"><button class="btn btn-secondary" type=button id=settings-cancel><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5 height=16 width=16 xmlns=http://www.w3.org/2000/svg><path d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15M12 9l3 3m0 0-3 3m3-3H2.25" stroke-linecap=round stroke-linejoin=round /></svg> Close</button></div></div></div><div class="hidden modal-overlay" id=details-modal><div class=modal><h2><span id=task-modal-title>Add Task</span></h2><form id=details-form><input name=id type=hidden><div class=modal-content><label for=modal-title>Title</label> <input name=title id=modal-title required placeholder="Task Title"> <label for=modal-description>Description</label> <textarea id=modal-description name=description placeholder="Purpose: The purpose is to ...&#10;- &#10;- &#10;- &#10;- "></textarea> <input name=label type=hidden value=none><div class=form-row id=row-labels><div class=form-column><label>Labels</label><div class=tag-selector id=tag-selector></div></div><div class=form-column></div></div><div class=form-row id=row-repeat><div class=form-column style=grid-column:1/-1><div class=repeat-task-header><label><input name=isRepeated type=checkbox id=modal-repeat-task> <svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="M1 4v6h6M23 20v-6h-6"/><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/></svg> Repeat Task</label><p class=repeat-hint>Automatically create new instances when completed</div></div></div><div class="hidden form-section" id=repeat-configuration><div class="form-row frequency-interval-compact"><div class=form-column><label for=modal-repeat-frequency>Frequency</label> <select id=modal-repeat-frequency name=repeatFrequency><option value=daily>Daily<option value=weekly selected>Weekly<option value=monthly>Monthly<option value=yearly>Yearly</select></div><div class=form-column><label for=modal-repeat-interval>Every</label><div class=repeat-interval-group><input name=repeatInterval type=number id=modal-repeat-interval min=1 max=365 value=1> <span id=repeat-interval-unit>weeks</span></div></div></div><div class="form-row hidden" id=row-repeat-days><div class=form-column style=grid-column:1/-1><label>Days of the week</label><div class=days-selector><label class=day-checkbox><input name=repeatDaysOfWeek type=checkbox value=0> Sun</label> <label class=day-checkbox><input name=repeatDaysOfWeek type=checkbox value=1> Mon</label> <label class=day-checkbox><input name=repeatDaysOfWeek type=checkbox value=2> Tue</label> <label class=day-checkbox><input name=repeatDaysOfWeek type=checkbox value=3> Wed</label> <label class=day-checkbox><input name=repeatDaysOfWeek type=checkbox value=4> Thu</label> <label class=day-checkbox><input name=repeatDaysOfWeek type=checkbox value=5> Fri</label> <label class=day-checkbox><input name=repeatDaysOfWeek type=checkbox value=6> Sat</label></div></div></div><div class=form-row><div class=form-column><label for=modal-repeat-end-date>End date (optional)</label> <input name=repeatEndDate type=date id=modal-repeat-end-date></div><div class=form-column><label for=modal-repeat-count>Max occurrences (optional)</label> <input name=repeatCount type=number id=modal-repeat-count min=1 placeholder="e.g., 10"></div></div></div><div class=form-row id=row-status><div class=form-column><label for=modal-status>Status</label> <select id=modal-status name=status><option value=doing>Doing<option value=postponed>Postponed<option value=finished>Finished<option value=cancelled>Cancelled</select></div><div class=form-column></div></div><div class=form-row id=row-due><div class=form-column><div class=date-group><label for=modal-due-date>Due Date</label> <input name=dueDate type=date id=modal-due-date><div class=quick-date-controls id=due-quick-controls><button class="btn btn-secondary" type=button id=date-next-week>Next Week</button> <button class="btn btn-secondary" type=button id=date-next-month>Next Month</button></div></div></div><div class=form-column></div></div><div class="form-row hidden" id=row-cancel-date><div class=form-column><label for=details-cancel-date>Cancellation date</label> <input name=cancelledDate type=date id=details-cancel-date></div><div class=form-column></div></div><div class="form-row finished-date-row"><div class=form-column><label for=modal-finished-date>Finished Date</label> <input name=finishedDate type=date id=modal-finished-date></div><div class=form-column></div></div><div class="form-row hidden" id=row-reason-postponed><div class=form-column style=grid-column:1/-1><label for=details-reason-postpone>Reason to postpone</label> <textarea id=details-reason-postpone name=postponeNote placeholder="Why postpone?"></textarea></div></div><div class="form-row hidden" id=row-reason-cancelled><div class=form-column style=grid-column:1/-1><label for=details-reason-cancel>Reason to cancel</label> <textarea id=details-reason-cancel name=cancelNote placeholder="Why cancel?"></textarea></div></div></div><div class=modal-actions><button class="btn btn-danger" type=button id=modal-delete><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2m3 0v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6h14z"/><path d="M10 11v6M14 11v6"/></svg> Delete</button> <button class="btn btn-secondary" type=button id=modal-cancel><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="M18 6 6 18M6 6l12 12"/></svg> Cancel</button> <button class="btn btn-primary" type=button id=modal-save><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="m4.5 12.75 6 6 9-13.5" stroke-linecap=round stroke-linejoin=round /></svg> Save</button></div></form></div></div><div class="hidden modal-overlay" id=import-export-modal><div class=modal><h2>Import & Export</h2><p class=modal-hint>Export downloads a backup JSON of your tasks, labels, and settings. Import replaces your current data with the selected backup file.<div class=modal-actions><button class="btn btn-secondary" type=button id=export-btn><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"/></svg> Export to JSON</button> <button class="btn btn-primary" type=button id=import-btn><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"/></svg> Import from JSON</button></div><input type=file id=import-file-input accept=.json class=hidden></div></div><div class="hidden modal-overlay" id=labels-modal><div class=modal><h2>Manage Labels</h2><div class=labels-list id=labels-list></div><form id=label-form class=label-form><input name=labelKey type=hidden><div class=label-preview id=label-preview><div class=label-color-dot id=preview-color></div><div class=label-info><div class=label-name id=preview-name>Enter label name</div><div class=label-details id=preview-details>Custom label</div></div></div><div class=form-row><div class=form-column><label for=label-name>Label Name</label> <input name=name id=label-name required placeholder="Enter label name" maxlength=50></div><div class=form-column><label for=label-color>Color</label><div class=color-presets id=color-presets><button class=color-preset type=button data-color=#ef4444 style=background-color:#ef4444 title=Red></button> <button class=color-preset type=button data-color=#f97316 style=background-color:#f97316 title=Orange></button> <button class=color-preset type=button data-color=#eab308 style=background-color:#eab308 title=Yellow></button> <button class=color-preset type=button data-color=#22c55e style=background-color:#22c55e title=Green></button> <button class=color-preset type=button data-color=#3b82f6 style=background-color:#3b82f6 title=Blue></button> <button class=color-preset type=button data-color=#8b5cf6 style=background-color:#8b5cf6 title=Purple></button> <button class=color-preset type=button data-color=#ec4899 style=background-color:#ec4899 title=Pink></button> <button class=color-preset type=button data-color=#6b7280 style=background-color:#6b7280 title=Gray></button></div><input name=color type=color id=label-color value=#6b7280></div></div><div class=modal-actions><button class="btn btn-secondary" type=button id=label-cancel><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="M18 6 6 18M6 6l12 12"/></svg> Cancel</button> <button class="btn btn-primary" type=submit id=label-save><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="m4.5 12.75 6 6 9-13.5" stroke-linecap=round stroke-linejoin=round /></svg> <span id=label-save-text>Add Label</span></button></div></form><div class=modal-actions><button class="btn btn-secondary" type=button id=labels-close><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5 height=16 width=16 xmlns=http://www.w3.org/2000/svg><path d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15M12 9l3 3m0 0-3 3m3-3H2.25" stroke-linecap=round stroke-linejoin=round /></svg> Close</button></div></div></div><div class="hidden modal-overlay" id=quick-status-modal><div class=modal><h2 id=quick-status-title>Update Status</h2><form id=quick-status-form><input name=taskId type=hidden> <input name=targetStatus type=hidden><div class="hidden form-section" id=quick-postpone-fields><div class=form-row><div class=form-column><label for=quick-due-date>New date</label> <input name=dueDate type=date id=quick-due-date required><div class=quick-date-controls><button class="btn btn-secondary" type=button id=quick-date-next-week>Next Week</button> <button class="btn btn-secondary" type=button id=quick-date-next-month>Next Month</button></div></div></div><div class=form-row><div class=form-column><label for=quick-postpone-note>Reason to postpone</label> <textarea id=quick-postpone-note name=postponeNote placeholder="Why postpone?" required></textarea></div></div></div><div class="hidden form-section" id=quick-cancel-fields><div class=form-row><div class=form-column><label for=quick-cancel-date>Cancellation date</label> <input name=cancelledDate type=date id=quick-cancel-date></div></div><div class=form-row><div class=form-column><label for=quick-cancel-note>Reason to cancel</label> <textarea id=quick-cancel-note name=cancelNote placeholder="Why cancel?" required></textarea></div></div></div><div class=modal-actions><button class="btn btn-secondary" type=button id=quick-status-cancel><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="M18 6 6 18M6 6l12 12"/></svg> Cancel</button> <button class="btn btn-primary" type=submit id=quick-status-save><svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 height=16 width=16><path d="m4.5 12.75 6 6 9-13.5" stroke-linecap=round stroke-linejoin=round /></svg> Save</button></div></form></div></div>